{
  "all_hints_text": "Inference shouldn't probably leak `Super` so we should look into that. Regarding `qname` I think it's fine as we have it right now, only for scoped nodes.\nIt is possible to return a super object in Python code:\r\n```\r\nclass C:\r\n   def foo(self): return super()\r\n```\r\n\r\nThis returns `<super: <class 'C'>, <C object>>`.  I don't know *why* you'd ever want to do this, but given this is Python someone has probably done it.  If the inference shouldn't return Super, what should it return for the above code?\nThat's a good point @ceridwen From my point of view, I was considering `Super` to be more of an internal object to astroid's inference engine, but you are right that there is no placeholder for it in some cases such as the one you mentioned, e.g when we just pass `super()` from one point to another.\r\nGiven this, it might make sense to have an empty string `qname()` for non-scoped nodes. Does that sounds good for you as well, Bryce? I'm afraid otherwise we'd have to guard almost every place in pylint where we use `qname()`.\n@PCManticore Yeah that sounds actionable. I didn't realize is `super()` is an instance of super after being called. I think the string should be `super` instead of an empty string because `type(super()).__qualname__` and `super.__qualname__` is `\"super\"`.\nIs it possible to cherry-pick this in to the 1.6 version stream and cut a 1.6.7? We are still porting from python2 to 3 and as far as I know (unless something has recently changed) we can only use python2 to perform `pylint --py3k` checking across python2 and 3 source code because of some pylint parser logic.\n\n",
  "base_commit": "c56cb34d2b7782097d4e2ba2e2b08081ca7aad55",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/37c8038789c920c1406e185d8f45f80ebdda24d1"
  ],
  "created_at": "2018-04-19T03:11:15Z",
  "hints_text": "Inference shouldn't probably leak `Super` so we should look into that. Regarding `qname` I think it's fine as we have it right now, only for scoped nodes.\nIt is possible to return a super object in Python code:\r\n```\r\nclass C:\r\n   def foo(self): return super()\r\n```\r\n\r\nThis returns `<super: <class 'C'>, <C object>>`.  I don't know *why* you'd ever want to do this, but given this is Python someone has probably done it.  If the inference shouldn't return Super, what should it return for the above code?\nThat's a good point @ceridwen From my point of view, I was considering `Super` to be more of an internal object to astroid's inference engine, but you are right that there is no placeholder for it in some cases such as the one you mentioned, e.g when we just pass `super()` from one point to another.\r\nGiven this, it might make sense to have an empty string `qname()` for non-scoped nodes. Does that sounds good for you as well, Bryce? I'm afraid otherwise we'd have to guard almost every place in pylint where we use `qname()`.\n@PCManticore Yeah that sounds actionable. I didn't realize is `super()` is an instance of super after being called. I think the string should be `super` instead of an empty string because `type(super()).__qualname__` and `super.__qualname__` is `\"super\"`.\n\n",
  "instance_id": "pylint-dev__astroid-537",
  "issue_numbers": [
    533
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex 8ca15eeb66..2914df9909 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -75,6 +75,11 @@ Change log for the astroid package (used to be astng)\n \n      Close #112\n \n+   * Add qname method to Super object preventing potential errors in upstream\n+     pylint\n+\n+     Close #533\n+\n \n 2017-12-15 -- 1.6.0\n \ndiff --git a/astroid/objects.py b/astroid/objects.py\nindex 7a8734491f..07ebbc8f52 100644\n--- a/astroid/objects.py\n+++ b/astroid/objects.py\n@@ -118,6 +118,9 @@ def name(self):\n         \"\"\"Get the name of the MRO pointer.\"\"\"\n         return self.mro_pointer.name\n \n+    def qname(self):\n+        return \"super\"\n+\n     def igetattr(self, name, context=None):\n         \"\"\"Retrieve the inferred values of the given attribute name.\"\"\"\n \n",
  "problem_statement": "Inference error linting django\n### Steps to reproduce\r\n1. Download django 2.0.4: https://github.com/django/django/archive/2.0.4.zip\r\n2. unzip, cd to directory\r\n3. run `pylint django/template/context.py`\r\n\r\n### Current behavior\r\n\r\nFails with an exception\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/lib64/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib64/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/user/pylint/pylint/__main__.py\", line 7, in <module>\r\n    pylint.run_pylint()\r\n  File \"/home/user/pylint/pylint/__init__.py\", line 18, in run_pylint\r\n    Run(sys.argv[1:])\r\n  File \"/home/user/pylint/pylint/lint.py\", line 1359, in __init__\r\n    linter.check(args)\r\n  File \"/home/user/pylint/pylint/lint.py\", line 779, in check\r\n    self._do_check(files_or_modules)\r\n  File \"/home/user/pylint/pylint/lint.py\", line 912, in _do_check\r\n    self.check_astroid_module(ast_node, walker, rawcheckers, tokencheckers)\r\n  File \"/home/user/pylint/pylint/lint.py\", line 992, in check_astroid_module\r\n    walker.walk(ast_node)\r\n  File \"/home/user/pylint/pylint/utils.py\", line 1036, in walk\r\n    self.walk(child)\r\n  File \"/home/user/pylint/pylint/utils.py\", line 1036, in walk\r\n    self.walk(child)\r\n  File \"/home/user/pylint/pylint/utils.py\", line 1036, in walk\r\n    self.walk(child)\r\n  File \"/home/user/pylint/pylint/utils.py\", line 1033, in walk\r\n    cb(astroid)\r\n  File \"/home/user/pylint/pylint/checkers/stdlib.py\", line 236, in visit_call\r\n    self._check_shallow_copy_environ(node)\r\n  File \"/home/user/pylint/pylint/checkers/stdlib.py\", line 208, in _check_shallow_copy_environ\r\n    if inferred.qname() == OS_ENVIRON:\r\nAttributeError: 'Super' object has no attribute 'qname'\r\n```\r\n\r\n### Expected behavior\r\n\r\nNo exception\r\n\r\n### Discussion\r\n\r\nShould inference be leaking `Super` nodes? Should we add `qname` for Non-scoped nodes (to `NodeNG`) (empty string or a series of names like `mymod.myclass.myfunc.mysuper`) ? or should this code be changed to have a guard conditional?\r\n\r\n### Version\r\n\r\nastroid commit: 5d77795885879572a3f0e9779f0ac88789f1d267\r\npylint commit: 164933412f685c407616866537fb16caecaef066\r\nPython 3.6.4\n",
  "pull_number": 537,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/astroid/tests/unittest_objects.py b/astroid/tests/unittest_objects.py\nindex 0dba8deaa3..dd317b612f 100644\n--- a/astroid/tests/unittest_objects.py\n+++ b/astroid/tests/unittest_objects.py\n@@ -502,6 +502,19 @@ def dict(self):\n         self.assertIsInstance(inferred, nodes.Const)\n         self.assertEqual(inferred.value, 42)\n \n+    def test_super_qname(self):\n+        \"\"\"Make sure a Super object generates a qname\n+        equivalent to super.__qname__\n+        \"\"\"\n+        # See issue 533\n+        code = \"\"\"\n+        class C:\n+           def foo(self): return super()\n+        C().foo() #@\n+        \"\"\"\n+        super_obj = next(builder.extract_node(code).infer())\n+        self.assertEqual(super_obj.qname(), \"super\")\n+\n \n if __name__ == '__main__':\n     unittest.main()\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/c56cb34d2b7782097d4e2ba2e2b08081ca7aad55"
}