{
  "all_hints_text": "Bisected it to PyCQA/astroid@9b114ad611e4f5c58551dbdcb3cf344b7731dec6\nGetting some `Astroid` parsing errors when trying to upgrade from `2.13.8` to `2.14.3`. Any workarounds?\nCan you share the traceback and a minimum code example? Your issue sounds unrelated because the issue being tracked in this issues stems from an unreleased version of astroid.\n@Meemaw it's almost surely not the same issue, as this one is linked to bleeding edge astroid which is not released. Could you open a new issue with some details please ?\nAhh, sorry @jacobtylerwalls @Pierre-Sassoulas   it felt connected. Reported as a separate issue: https://github.com/PyCQA/pylint/issues/6986\n@jacobtylerwalls This was a bug that I merged but I haven't looked into. Did you do some digging already or only the bisect?\nI just did the bisect at the time, but I'm digging now. The failure looks deeper/unrelated and the commit I blamed got unlucky by doing more inference.\r\n\r\nSomething do with an infinite loop when inferring an import from.\r\n\r\nTake the primer file `.../pandas_dev/pandas/pandas/core/arrays/_mixins.py` and reduce it to just:\r\n```python\r\nfrom pandas.core.algorithms import take\r\n```\r\n\r\nAnd it hits an infinite loop in the python stdlib where `linecache` imports `tokenize`, where that imports `from token import *`. We hit an infinite loop at `ImportNode.do_import_module` where we don't match the condition that is supposed to prevent an infinite loop. That's as far as I got just now. Shall we move this to `astroid` so we don't get more comments on it here?\r\n\nClosing per https://github.com/PyCQA/astroid/pull/1660#issuecomment-1172900987 in discussion with @DanielNoord.\n\n",
  "base_commit": "3dfbcb55250857a17f271a95183af951ec7dc88b",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/0e192e6d73b5fd0166391747aea10c69b2a6a13c",
    "https://github.com/pylint-dev/astroid/commit/2eef97a38fa1f6c2eb7fd40e006e2ff9d9b70154"
  ],
  "created_at": "2022-07-11T12:46:35Z",
  "hints_text": "Bisected it to PyCQA/astroid@9b114ad611e4f5c58551dbdcb3cf344b7731dec6\nGetting some `Astroid` parsing errors when trying to upgrade from `2.13.8` to `2.14.3`. Any workarounds?\nCan you share the traceback and a minimum code example? Your issue sounds unrelated because the issue being tracked in this issues stems from an unreleased version of astroid.\n@Meemaw it's almost surely not the same issue, as this one is linked to bleeding edge astroid which is not released. Could you open a new issue with some details please ?\nAhh, sorry @jacobtylerwalls @Pierre-Sassoulas   it felt connected. Reported as a separate issue: https://github.com/PyCQA/pylint/issues/6986\n@jacobtylerwalls This was a bug that I merged but I haven't looked into. Did you do some digging already or only the bisect?\nI just did the bisect at the time, but I'm digging now. The failure looks deeper/unrelated and the commit I blamed got unlucky by doing more inference.\r\n\r\nSomething do with an infinite loop when inferring an import from.\r\n\r\nTake the primer file `.../pandas_dev/pandas/pandas/core/arrays/_mixins.py` and reduce it to just:\r\n```python\r\nfrom pandas.core.algorithms import take\r\n```\r\n\r\nAnd it hits an infinite loop in the python stdlib where `linecache` imports `tokenize`, where that imports `from token import *`. We hit an infinite loop at `ImportNode.do_import_module` where we don't match the condition that is supposed to prevent an infinite loop. That's as far as I got just now. Shall we move this to `astroid` so we don't get more comments on it here?\r\n\nClosing per https://github.com/PyCQA/astroid/pull/1660#issuecomment-1172900987 in discussion with @DanielNoord.\n\n",
  "instance_id": "pylint-dev__astroid-1705",
  "issue_numbers": [
    1646
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex f62daaf26b..7544caa58c 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -16,6 +16,10 @@ Release date: TBA\n \n   Closes #1700\n \n+* Fixed crash with recursion limits during inference.\n+\n+  Closes #1646\n+\n What's New in astroid 2.12.1?\n =============================\n Release date: 2022-07-10\ndiff --git a/astroid/decorators.py b/astroid/decorators.py\nindex 03b345867c..c4f44dcd27 100644\n--- a/astroid/decorators.py\n+++ b/astroid/decorators.py\n@@ -145,6 +145,10 @@ def raise_if_nothing_inferred(func, instance, args, kwargs):\n         raise InferenceError(\n             \"StopIteration raised without any error information.\"\n         ) from error\n+    except RecursionError as error:\n+        raise InferenceError(\n+            f\"RecursionError raised with limit {sys.getrecursionlimit()}.\"\n+        ) from error\n \n     yield from generator\n \n",
  "problem_statement": "Infinite loop when inferring `from token import *`\n### Bug description\n\nhttps://github.com/PyCQA/pylint/commit/600a47e13e3df1ca42521c653ab0ebed5739d485 and its associated primer run creates a crash in `pandas`.\r\n\r\nSee:\r\nhttps://github.com/PyCQA/pylint/runs/6914161031?check_suite_focus=true\r\n\r\nLast good run:\r\nhttps://github.com/PyCQA/pylint/runs/6909775916?check_suite_focus=true\r\n\r\nI'm not sure though if this is due to the commit or a change in the projects we are linting. The commit of `pandas` changed.\r\n\r\n\n\n### Configuration\n\n```ini\n/\n```\n\n\n### Command used\n\n```shell\n/\n```\n\n\n### Pylint output\n\n```shell\n/\n```\n\n\n### Expected behavior\n\n/\n\n### Pylint version\n\n```shell\n/\n```\n\n\n### OS / Environment\n\n_No response_\n\n### Additional dependencies\n\n_No response_\n",
  "pull_number": 1705,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/unittest_regrtest.py b/tests/unittest_regrtest.py\nindex c3feda90dc..806e6fe0ad 100644\n--- a/tests/unittest_regrtest.py\n+++ b/tests/unittest_regrtest.py\n@@ -5,11 +5,12 @@\n import sys\n import textwrap\n import unittest\n+from unittest import mock\n \n import pytest\n \n from astroid import MANAGER, Instance, bases, nodes, parse, test_utils\n-from astroid.builder import AstroidBuilder, extract_node\n+from astroid.builder import AstroidBuilder, _extract_single_node, extract_node\n from astroid.const import PY38_PLUS\n from astroid.context import InferenceContext\n from astroid.exceptions import InferenceError\n@@ -420,5 +421,22 @@ def test_max_inferred_for_complicated_class_hierarchy() -> None:\n     assert super_node.getattr(\"__init__\", context=context)[0] == Uninferable\n \n \n+@mock.patch(\n+    \"astroid.nodes.ImportFrom._infer\",\n+    side_effect=RecursionError,\n+)\n+def test_recursion_during_inference(mocked) -> None:\n+    \"\"\"Check that we don't crash if we hit the recursion limit during inference.\"\"\"\n+    node: nodes.Call = _extract_single_node(\n+        \"\"\"\n+    from module import something\n+    something()\n+    \"\"\"\n+    )\n+    with pytest.raises(InferenceError) as error:\n+        next(node.infer())\n+    assert error.value.message.startswith(\"RecursionError raised\")\n+\n+\n if __name__ == \"__main__\":\n     unittest.main()\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/3dfbcb55250857a17f271a95183af951ec7dc88b"
}