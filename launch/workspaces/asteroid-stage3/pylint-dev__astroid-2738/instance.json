{
  "all_hints_text": "Note that `slice` itself is not a callable, so the code above would fail in production as well.\n```py\n>>> slice(-2)()\nTraceback (most recent call last):\n  File \"<python-input-1>\", line 1, in <module>\n    slice(-2)()\n    ~~~~~~~~~^^\nTypeError: 'slice' object is not callable\n```\nThank you again for the fuzzing work @correctmost \n\n",
  "base_commit": "59f36e755d04765b2b623c7c51e84509c6b248f6",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/a5022dc38b1b2777224cdc920df8ca21c82aa4dd"
  ],
  "created_at": "2025-05-13T06:45:24Z",
  "hints_text": "Note that `slice` itself is not a callable, so the code above would fail in production as well.\n```py\n>>> slice(-2)()\nTraceback (most recent call last):\n  File \"<python-input-1>\", line 1, in <module>\n    slice(-2)()\n    ~~~~~~~~~^^\nTypeError: 'slice' object is not callable\n```\n\n",
  "instance_id": "pylint-dev__astroid-2738",
  "issue_numbers": [
    2721
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex c9744b921..f7280b8f0 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -41,6 +41,11 @@ Release date: TBA\n \n   Closes #2734\n \n+* Fix a crash when parsing a slice called in a decorator on a function that is also decorated with\n+  a known ``six`` decorator.\n+\n+  Closes #2721\n+\n What's New in astroid 3.3.10?\n =============================\n Release date: 2025-05-10\ndiff --git a/astroid/brain/brain_six.py b/astroid/brain/brain_six.py\nindex c222a4220..12180097e 100644\n--- a/astroid/brain/brain_six.py\n+++ b/astroid/brain/brain_six.py\n@@ -182,7 +182,11 @@ def transform_six_add_metaclass(node):  # pylint: disable=inconsistent-return-st\n             func = next(decorator.func.infer())\n         except (InferenceError, StopIteration):\n             continue\n-        if func.qname() == SIX_ADD_METACLASS and decorator.args:\n+        if (\n+            isinstance(func, (nodes.FunctionDef, nodes.ClassDef))\n+            and func.qname() == SIX_ADD_METACLASS\n+            and decorator.args\n+        ):\n             metaclass = decorator.args[0]\n             node._metaclass = metaclass\n             return node\n",
  "problem_statement": "AttributeError: 'Slice' object has no attribute 'qname' on fuzzed code\n### Steps to reproduce\n\nThe following code triggers an `AttributeError` in astroid:\n\n```python\ns = slice(-2)\n@s()\n@six.add_metaclass()\nclass a: ...\n```\n\nThis bug was discovered by OSS-Fuzz:\nhttps://issues.oss-fuzz.com/issues/409585564 (report not public yet)\n\n### Current behavior\n```\nTraceback (most recent call last):\n  File \"pylint/lint/pylinter.py\", line 994, in get_ast\n    return MANAGER.ast_from_file(filepath, modname, source=True)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"astroid/manager.py\", line 165, in ast_from_file\n    return AstroidBuilder(self).file_build(filepath, modname)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"astroid/builder.py\", line 145, in file_build\n    return self._post_build(module, builder, encoding)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"astroid/builder.py\", line 173, in _post_build\n    module = self._manager.visit_transforms(module)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"astroid/manager.py\", line 129, in visit_transforms\n    return self._transform.visit(node)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"astroid/transforms.py\", line 162, in visit\n    return self._visit(node)\n           ^^^^^^^^^^^^^^^^^\n  File \"astroid/transforms.py\", line 84, in _visit\n    visited = self._visit_generic(value)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"astroid/transforms.py\", line 112, in _visit_generic\n    return [self._visit_generic(child) for child in node]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"astroid/transforms.py\", line 112, in <listcomp>\n    return [self._visit_generic(child) for child in node]\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"astroid/transforms.py\", line 119, in _visit_generic\n    return self._visit(node)\n           ^^^^^^^^^^^^^^^^^\n  File \"astroid/transforms.py\", line 87, in _visit\n    return self._transform(node)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"astroid/transforms.py\", line 67, in _transform\n    ret = transform_func(node)\n          ^^^^^^^^^^^^^^^^^^^^\n  File \"astroid/brain/brain_six.py\", line 185, in transform_six_add_metaclass\n    if func.qname() == SIX_ADD_METACLASS and decorator.args:\n       ^^^^^^^^^^\nAttributeError: 'Slice' object has no attribute 'qname'\n```\n\n### Expected behavior\nNo crash\n\n### Version\nce81c290efa0\n\n",
  "pull_number": 2738,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/test_regrtest.py b/tests/test_regrtest.py\nindex 5321c7e0c..528af7a55 100644\n--- a/tests/test_regrtest.py\n+++ b/tests/test_regrtest.py\n@@ -504,3 +504,19 @@ def test_regression_no_crash_during_build() -> None:\n     node: nodes.Attribute = extract_node(\"__()\")\n     assert node.args == []\n     assert node.as_string() == \"__()\"\n+\n+\n+def test_regression_no_crash_on_called_slice() -> None:\n+    \"\"\"Regression test for issue #2721.\"\"\"\n+    node: nodes.Attribute = extract_node(\n+        textwrap.dedent(\n+            \"\"\"\n+        s = slice(-2)\n+        @s()\n+        @six.add_metaclass()\n+        class a: ...\n+        \"\"\"\n+        )\n+    )\n+    assert isinstance(node, nodes.ClassDef)\n+    assert node.name == \"a\"\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/59f36e755d04765b2b623c7c51e84509c6b248f6"
}