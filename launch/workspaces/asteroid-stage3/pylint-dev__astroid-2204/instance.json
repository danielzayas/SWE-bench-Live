{
  "all_hints_text": "Thanks! \r\n\r\nLooks like assigning to the attributes of AstroidManager (rather than mutating the existing values) is unsafe, as it will never \"talk back\" to the global state on the class.\r\n\r\nWe should get rid of the instance attributes. We could rewrite them as properties that mutate the global state when set, or we could also just prevent instantiation of AstroidManager at all, forcing everyone to deal with the global state. The former is the slimmer fix. Would you like to prepare a patch?\n\n",
  "base_commit": "bd78ab0a70d1341db4ac5cdb4ef899ff91033679",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/bc42b405afecea9995f5daff51e70ab44c0de811",
    "https://github.com/pylint-dev/astroid/commit/d00b3969bdb2a498c9f771ae505558f6288dcd27",
    "https://github.com/pylint-dev/astroid/commit/5effdf816d1a945b7920a28fa256a44bd4afe69b",
    "https://github.com/pylint-dev/astroid/commit/e970e013509e6ef5abc000f4a72114252b7ec641",
    "https://github.com/pylint-dev/astroid/commit/1124eea943c6454d013e6b8675cde9821ba2bc5f",
    "https://github.com/pylint-dev/astroid/commit/6c105ad2994aef4610ba920931a895c9a4754ebe"
  ],
  "created_at": "2023-06-07T13:23:20Z",
  "hints_text": "\n\n",
  "instance_id": "pylint-dev__astroid-2204",
  "issue_numbers": [
    2200
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex 58587dc7dd..41ba0d586c 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -147,6 +147,11 @@ Release date: TBA\n \n   Refs pylint-dev/pylint#8598\n \n+* Fix a regression in 2.12.0 where settings in AstroidManager would be ignored.\n+  Most notably this addresses pylint-dev/pylint#7433.\n+\n+  Refs #2204\n+\n \n What's New in astroid 2.15.5?\n =============================\ndiff --git a/astroid/manager.py b/astroid/manager.py\nindex 7b026303a2..2df270f1ac 100644\n--- a/astroid/manager.py\n+++ b/astroid/manager.py\n@@ -69,13 +69,27 @@ def __init__(self) -> None:\n         self.astroid_cache = AstroidManager.brain[\"astroid_cache\"]\n         self._mod_file_cache = AstroidManager.brain[\"_mod_file_cache\"]\n         self._failed_import_hooks = AstroidManager.brain[\"_failed_import_hooks\"]\n-        self.always_load_extensions = AstroidManager.brain[\"always_load_extensions\"]\n-        self.optimize_ast = AstroidManager.brain[\"optimize_ast\"]\n         self.extension_package_whitelist = AstroidManager.brain[\n             \"extension_package_whitelist\"\n         ]\n         self._transform = AstroidManager.brain[\"_transform\"]\n \n+    @property\n+    def always_load_extensions(self) -> bool:\n+        return AstroidManager.brain[\"always_load_extensions\"]\n+\n+    @always_load_extensions.setter\n+    def always_load_extensions(self, value: bool) -> None:\n+        AstroidManager.brain[\"always_load_extensions\"] = value\n+\n+    @property\n+    def optimize_ast(self) -> bool:\n+        return AstroidManager.brain[\"optimize_ast\"]\n+\n+    @optimize_ast.setter\n+    def optimize_ast(self, value: bool) -> None:\n+        AstroidManager.brain[\"optimize_ast\"] = value\n+\n     @property\n     def register_transform(self):\n         # This and unregister_transform below are exported for convenience\n",
  "problem_statement": "Invariance \"MANAGER.__dict__ == manager.AstroidManager.brain\" no longer holds\n### Steps to reproduce\r\nUp until commit bbcc58bd52e7f295b77a8618b19b2364625590a2 the following equality would be guaranteed:\r\n\r\n```\r\nassert MANAGER.always_load_extensions == manager.AstroidManager.brain['always_load_extensions']\r\n```\r\n\r\nThis apparently causes https://github.com/pylint-dev/pylint/issues/7433\n",
  "pull_number": 2204,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/test_regrtest.py b/tests/test_regrtest.py\nindex 59d344b954..f525451a2e 100644\n--- a/tests/test_regrtest.py\n+++ b/tests/test_regrtest.py\n@@ -9,7 +9,7 @@\n \n import pytest\n \n-from astroid import MANAGER, Instance, bases, nodes, parse, test_utils\n+from astroid import MANAGER, Instance, bases, manager, nodes, parse, test_utils\n from astroid.builder import AstroidBuilder, _extract_single_node, extract_node\n from astroid.context import InferenceContext\n from astroid.exceptions import InferenceError\n@@ -36,6 +36,24 @@ def tearDown(self) -> None:\n         sys.path.pop(0)\n         sys.path_importer_cache.pop(resources.find(\"data\"), None)\n \n+    def test_manager_instance_attributes_reference_global_MANAGER(self) -> None:\n+        for expected in (True, False):\n+            with mock.patch.dict(\n+                manager.AstroidManager.brain,\n+                values={\"always_load_extensions\": expected},\n+            ):\n+                assert (\n+                    MANAGER.always_load_extensions\n+                    == manager.AstroidManager.brain[\"always_load_extensions\"]\n+                )\n+            with mock.patch.dict(\n+                manager.AstroidManager.brain,\n+                values={\"optimize_ast\": expected},\n+            ):\n+                assert (\n+                    MANAGER.optimize_ast == manager.AstroidManager.brain[\"optimize_ast\"]\n+                )\n+\n     def test_module_path(self) -> None:\n         man = test_utils.brainless_manager()\n         mod = man.ast_from_module_name(\"package.import_package_subpackage_module\")\n@@ -49,9 +67,9 @@ def test_module_path(self) -> None:\n         self.assertEqual(module.name, \"package.subpackage.module\")\n \n     def test_package_sidepackage(self) -> None:\n-        manager = test_utils.brainless_manager()\n+        brainless_manager = test_utils.brainless_manager()\n         assert \"package.sidepackage\" not in MANAGER.astroid_cache\n-        package = manager.ast_from_module_name(\"absimp\")\n+        package = brainless_manager.ast_from_module_name(\"absimp\")\n         self.assertIsInstance(package, nodes.Module)\n         self.assertTrue(package.package)\n         subpackage = next(package.getattr(\"sidepackage\")[0].infer())\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/bd78ab0a70d1341db4ac5cdb4ef899ff91033679"
}