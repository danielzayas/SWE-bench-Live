{
  "all_hints_text": "OSS-Fuzz discovered another `IndexError` when there's only one argument to `_alias` ([OSS-Fuzz bug report](https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64639)):\r\n\r\n```python\r\na = _alias(int)\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"pylint/pylint/checkers/utils.py\", line 1365, in safe_infer\r\n    value = next(infer_gen)\r\n            ^^^^^^^^^^^^^^^\r\n  File \"astroid/astroid/nodes/node_ng.py\", line 147, in infer\r\n    for result in self._explicit_inference(\r\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"astroid/astroid/inference_tip.py\", line 70, in inner\r\n    raise e from None\r\n  File \"astroid/astroid/inference_tip.py\", line 66, in inner\r\n    func(node, context, **kwargs)\r\n  File \"astroid/astroid/brain/brain_typing.py\", line 330, in infer_typing_alias\r\n    maybe_type_var = node.args[1]\r\n                     ~~~~~~~~~^^^\r\nIndexError: list index out of range\r\n```\r\n\r\nIt seems like a comprehensive fix can handle both crashes.  If not, I will file this issue separately.\n\n",
  "base_commit": "a8439ff4f822cde57151f083d987a7b7ed593fbf",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/58a3c28feac91b84dba9fe1a9aed54478616d709"
  ],
  "created_at": "2024-10-23T17:48:15Z",
  "hints_text": "OSS-Fuzz discovered another `IndexError` when there's only one argument to `_alias` ([OSS-Fuzz bug report](https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64639)):\r\n\r\n```python\r\na = _alias(int)\r\n```\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"pylint/pylint/checkers/utils.py\", line 1365, in safe_infer\r\n    value = next(infer_gen)\r\n            ^^^^^^^^^^^^^^^\r\n  File \"astroid/astroid/nodes/node_ng.py\", line 147, in infer\r\n    for result in self._explicit_inference(\r\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"astroid/astroid/inference_tip.py\", line 70, in inner\r\n    raise e from None\r\n  File \"astroid/astroid/inference_tip.py\", line 66, in inner\r\n    func(node, context, **kwargs)\r\n  File \"astroid/astroid/brain/brain_typing.py\", line 330, in infer_typing_alias\r\n    maybe_type_var = node.args[1]\r\n                     ~~~~~~~~~^^^\r\nIndexError: list index out of range\r\n```\r\n\r\nIt seems like a comprehensive fix can handle both crashes.  If not, I will file this issue separately.\n\n",
  "instance_id": "pylint-dev__astroid-2623",
  "issue_numbers": [
    2513
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex 036f888e08..8ab5375b4f 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -17,6 +17,10 @@ Release date: TBA\n   Closes #2521\n   Closes #2523\n \n+* Fix crash when typing._alias() call is missing arguments.\n+\n+  Closes #2513\n+\n \n What's New in astroid 3.3.6?\n ============================\ndiff --git a/astroid/brain/brain_typing.py b/astroid/brain/brain_typing.py\nindex 239e63af24..c44687bf89 100644\n--- a/astroid/brain/brain_typing.py\n+++ b/astroid/brain/brain_typing.py\n@@ -258,6 +258,7 @@ def _looks_like_typing_alias(node: Call) -> bool:\n         isinstance(node.func, Name)\n         # TODO: remove _DeprecatedGenericAlias when Py3.14 min\n         and node.func.name in {\"_alias\", \"_DeprecatedGenericAlias\"}\n+        and len(node.args) == 2\n         and (\n             # _alias function works also for builtins object such as list and dict\n             isinstance(node.args[0], (Attribute, Name))\n",
  "problem_statement": "IndexError when _alias() has no arguments \n### Bug description\r\n\r\n```python\r\n_alias()\r\n```\r\n\r\nThis bug was discovered by OSS-Fuzz:\r\nhttps://bugs.chromium.org/p/oss-fuzz/issues/detail?id=57984 (report not public yet)\r\n\r\n\r\n### Configuration\r\n\r\n```ini\r\nN/A\r\n```\r\n\r\n\r\n### Command used\r\n\r\n```shell\r\npylint a.py\r\n```\r\n\r\n\r\n### Pylint output\r\n\r\n<details open>\r\n    <summary>Stacktrace</summary>\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/s/code/pylint/pylint/lint/pylinter.py\", line 974, in get_ast\r\n    return MANAGER.ast_from_file(filepath, modname, source=True)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/manager.py\", line 167, in ast_from_file\r\n    return AstroidBuilder(self).file_build(filepath, modname)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/builder.py\", line 145, in file_build\r\n    return self._post_build(module, builder, encoding)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/builder.py\", line 173, in _post_build\r\n    module = self._manager.visit_transforms(module)\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/manager.py\", line 128, in visit_transforms\r\n    return self._transform.visit(node)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/transforms.py\", line 162, in visit\r\n    return self._visit(node)\r\n           ^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/transforms.py\", line 84, in _visit\r\n    visited = self._visit_generic(value)\r\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/transforms.py\", line 112, in _visit_generic\r\n    return [self._visit_generic(child) for child in node]\r\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/transforms.py\", line 119, in _visit_generic\r\n    return self._visit(node)\r\n           ^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/transforms.py\", line 84, in _visit\r\n    visited = self._visit_generic(value)\r\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/transforms.py\", line 119, in _visit_generic\r\n    return self._visit(node)\r\n           ^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/transforms.py\", line 87, in _visit\r\n    return self._transform(node)\r\n           ^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/transforms.py\", line 66, in _transform\r\n    if predicate is None or predicate(node):\r\n                            ^^^^^^^^^^^^^^^\r\n  File \"/home/s/code/astroid/astroid/brain/brain_typing.py\", line 262, in _looks_like_typing_alias\r\n    isinstance(node.args[0], (Attribute, Name))\r\n               ~~~~~~~~~^^^\r\nIndexError: list index out of range\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/s/code/pylint/pylint/lint/pylinter.py\", line 714, in _get_asts\r\n    ast_per_fileitem[fileitem] = self.get_ast(\r\n                                 ^^^^^^^^^^^^^\r\n  File \"/home/s/code/pylint/pylint/lint/pylinter.py\", line 996, in get_ast\r\n    raise astroid.AstroidBuildingError(\r\nastroid.exceptions.AstroidBuildingError: Building error when trying to create ast representation of module 'input'\r\n```\r\n\r\n</details>\r\n\r\n\r\n### Expected behavior\r\n\r\nNo crash\r\n\r\n### Pylint version\r\n\r\npylint 6bb335f5ca2c52a994d5836eee63dc2c140fc5f3\r\npylint-dev/astroid@f924ba2299328dc4d138ac9117edbfd0581f880b\r\n\r\n### OS / Environment\r\n\r\nArch Linux\r\n\r\n### Additional dependencies\r\n\r\n_No response_\n",
  "pull_number": 2623,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/brain/test_typing.py b/tests/brain/test_typing.py\nindex 1e8e3eaf88..11b77b7f9e 100644\n--- a/tests/brain/test_typing.py\n+++ b/tests/brain/test_typing.py\n@@ -4,7 +4,7 @@\n \n import pytest\n \n-from astroid import builder\n+from astroid import bases, builder, nodes\n from astroid.exceptions import InferenceError\n \n \n@@ -23,3 +23,50 @@ def test_infer_typevar() -> None:\n     )\n     with pytest.raises(InferenceError):\n         call_node.inferred()\n+\n+\n+class TestTypingAlias:\n+    def test_infer_typing_alias(self) -> None:\n+        \"\"\"\n+        Test that _alias() calls can be inferred.\n+        \"\"\"\n+        node = builder.extract_node(\n+            \"\"\"\n+            from typing import _alias\n+            x = _alias(int, float)\n+            \"\"\"\n+        )\n+        assert isinstance(node, nodes.Assign)\n+        assert isinstance(node.value, nodes.Call)\n+        inferred = next(node.value.infer())\n+        assert isinstance(inferred, nodes.ClassDef)\n+        assert len(inferred.bases) == 1\n+        assert inferred.bases[0].name == \"int\"\n+\n+    @pytest.mark.parametrize(\n+        \"alias_args\",\n+        [\n+            \"\",  # two missing arguments\n+            \"int\",  # one missing argument\n+            \"int, float, tuple\",  # one additional argument\n+        ],\n+    )\n+    def test_infer_typing_alias_incorrect_number_of_arguments(\n+        self, alias_args: str\n+    ) -> None:\n+        \"\"\"\n+        Regression test for: https://github.com/pylint-dev/astroid/issues/2513\n+\n+        Test that _alias() calls with the incorrect number of arguments can be inferred.\n+        \"\"\"\n+        node = builder.extract_node(\n+            f\"\"\"\n+            from typing import _alias\n+            x = _alias({alias_args})\n+            \"\"\"\n+        )\n+        assert isinstance(node, nodes.Assign)\n+        assert isinstance(node.value, nodes.Call)\n+        inferred = next(node.value.infer())\n+        assert isinstance(inferred, bases.Instance)\n+        assert inferred.name == \"_SpecialGenericAlias\"\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/a8439ff4f822cde57151f083d987a7b7ed593fbf"
}