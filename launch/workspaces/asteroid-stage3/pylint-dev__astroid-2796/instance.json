{
  "all_hints_text": "\n\n",
  "base_commit": "8caf6660eace22d9454a300d7d27d6a3aa802272",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/6cbd7078b448dd8942864c0751d3b2b71a35534c",
    "https://github.com/pylint-dev/astroid/commit/fcc4c62a7788ddbe58866ffa0ef45d4170e3856e"
  ],
  "created_at": "2025-08-08T13:20:29Z",
  "hints_text": "\n\n",
  "instance_id": "pylint-dev__astroid-2796",
  "issue_numbers": [
    2522
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex 48644947e..cccaa0242 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -7,6 +7,10 @@ What's New in astroid 4.0.0?\n ============================\n Release date: TBA\n \n+* Fix crash when comparing invalid dict literal\n+\n+  Closes #2522\n+\n * Removed internal functions ``infer_numpy_member``, ``name_looks_like_numpy_member``, and\n   ``attribute_looks_like_numpy_member`` from ``astroid.brain.brain_numpy_utils``.\n \ndiff --git a/astroid/nodes/node_classes.py b/astroid/nodes/node_classes.py\nindex 0fab642ad..372ada7a6 100644\n--- a/astroid/nodes/node_classes.py\n+++ b/astroid/nodes/node_classes.py\n@@ -1851,7 +1851,7 @@ def last_child(self):\n     # TODO: move to util?\n     @staticmethod\n     def _to_literal(node: SuccessfulInferenceResult) -> Any:\n-        # Can raise SyntaxError or ValueError from ast.literal_eval\n+        # Can raise SyntaxError, ValueError, or TypeError from ast.literal_eval\n         # Can raise AttributeError from node.as_string() as not all nodes have a visitor\n         # Is this the stupidest idea or the simplest idea?\n         return ast.literal_eval(node.as_string())\n@@ -1887,7 +1887,7 @@ def _do_compare(\n \n             try:\n                 left, right = self._to_literal(left), self._to_literal(right)\n-            except (SyntaxError, ValueError, AttributeError):\n+            except (SyntaxError, ValueError, AttributeError, TypeError):\n                 return util.Uninferable\n \n             try:\n",
  "problem_statement": "\"TypeError: unhashable type: 'dict'\" when comparing invalid dict literal\n### Steps to reproduce\r\nThe following code triggers a `TypeError` in astroid:\r\n\r\n```python\r\na = {{}} > 0\r\n```\r\n\r\nThis bug was discovered by OSS-Fuzz:\r\nhttps://bugs.chromium.org/p/oss-fuzz/issues/detail?id=60641 (report not public yet)\r\n\r\n### Current behavior\r\n```\r\nException on node <AssignName.a l.1 at 0x7d1710ba9310> in file 'corpus/a.py'\r\nTraceback (most recent call last):\r\n  File \"pylint/pylint/checkers/utils.py\", line 1365, in safe_infer\r\n    value = next(infer_gen)\r\n            ^^^^^^^^^^^^^^^\r\n  File \"astroid/astroid/nodes/node_ng.py\", line 168, in infer\r\n    for i, result in enumerate(self._infer(context=context, **kwargs)):\r\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"astroid/astroid/nodes/node_classes.py\", line 1926, in _infer\r\n    retval = self._do_compare(lhs, op, rhs)\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"astroid/astroid/nodes/node_classes.py\", line 1894, in _do_compare\r\n    left, right = self._to_literal(left), self._to_literal(right)\r\n                  ^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"astroid/astroid/nodes/node_classes.py\", line 1862, in _to_literal\r\n    return ast.literal_eval(node.as_string())\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/usr/lib/python3.12/ast.py\", line 112, in literal_eval\r\n    return _convert(node_or_string)\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"/usr/lib/python3.12/ast.py\", line 94, in _convert\r\n    return set(map(_convert, node.elts))\r\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nTypeError: unhashable type: 'dict'\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"pylint/pylint/utils/ast_walker.py\", line 91, in walk\r\n    callback(astroid)\r\n  File \"pylint/pylint/checkers/base/name_checker/checker.py\", line 423, in visit_assignname\r\n    inferred_assign_type = utils.safe_infer(assign_type.value)\r\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File \"pylint/pylint/checkers/utils.py\", line 1369, in safe_infer\r\n    raise AstroidError from e\r\nastroid.exceptions.AstroidError\r\n```\r\n\r\n### Expected behavior\r\nNo crash\r\n\r\n### Version\r\nd8dbc462243a65d72153ace2e7ac87daa9ffc1cf\n",
  "pull_number": 2796,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/test_regrtest.py b/tests/test_regrtest.py\nindex 861f4e262..9fcc378dc 100644\n--- a/tests/test_regrtest.py\n+++ b/tests/test_regrtest.py\n@@ -543,3 +543,10 @@ class a: ...\n     )\n     assert isinstance(node, nodes.ClassDef)\n     assert node.name == \"a\"\n+\n+\n+def test_regression_infer_dict_literal_comparison_uninferable() -> None:\n+    \"\"\"Regression test for issue #2522.\"\"\"\n+    node = extract_node(\"{{}}>0\")\n+    inferred = next(node.infer())\n+    assert inferred.value == Uninferable\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/8caf6660eace22d9454a300d7d27d6a3aa802272"
}