{
  "all_hints_text": "I'm seeing similar 2.5-related issues with Enum subclasses. Particularly, `Enum.__members__.items()`. Pylint complains about `__members__` have not member `items` which is incorrect.\nWith pylint 2.6.2, and astroid 2.4.2, everything is fine. With astroid 2.5:\r\n\r\n(note lazy_object_proxy 1.5.2 is present)\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 582, in _build_master\r\n    ws.require(__requires__)\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 899, in require\r\n    needed = self.resolve(parse_requirements(requirements))\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 790, in resolve\r\n    raise VersionConflict(dist, req).with_context(dependent_req)\r\npkg_resources.ContextualVersionConflict: (lazy-object-proxy 0.0.0 (/usr/lib64/python3.9/site-packages), Requirement.parse('lazy_object_proxy>=1.4.0'), {'astroid'})\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/pylint-3\", line 33, in <module>\r\n    sys.exit(load_entry_point('pylint==2.6.2', 'console_scripts', 'pylint')())\r\n  File \"/usr/lib/python3.9/site-packages/pylint/__init__.py\", line 19, in run_pylint\r\n    from pylint.lint import Run as PylintRun\r\n  File \"/usr/lib/python3.9/site-packages/pylint/lint/__init__.py\", line 75, in <module>\r\n    from pylint.lint.check_parallel import check_parallel\r\n  File \"/usr/lib/python3.9/site-packages/pylint/lint/check_parallel.py\", line 7, in <module>\r\n    from pylint import reporters\r\n  File \"/usr/lib/python3.9/site-packages/pylint/reporters/__init__.py\", line 24, in <module>\r\n    from pylint import utils\r\n  File \"/usr/lib/python3.9/site-packages/pylint/utils/__init__.py\", line 47, in <module>\r\n    from pylint.utils.ast_walker import ASTWalker\r\n  File \"/usr/lib/python3.9/site-packages/pylint/utils/ast_walker.py\", line 6, in <module>\r\n    from astroid import nodes\r\n  File \"/usr/lib/python3.9/site-packages/astroid/__init__.py\", line 66, in <module>\r\n    from astroid.nodes import *\r\n  File \"/usr/lib/python3.9/site-packages/astroid/nodes.py\", line 23, in <module>\r\n    from astroid.node_classes import (\r\n  File \"/usr/lib/python3.9/site-packages/astroid/node_classes.py\", line 44, in <module>\r\n    from astroid import bases\r\n  File \"/usr/lib/python3.9/site-packages/astroid/bases.py\", line 36, in <module>\r\n    MANAGER = manager.AstroidManager()\r\n  File \"/usr/lib/python3.9/site-packages/astroid/util.py\", line 27, in <lambda>\r\n    lambda: importlib.import_module(\".\" + module_name, \"astroid\")\r\n  File \"/usr/lib64/python3.9/importlib/__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"/usr/lib/python3.9/site-packages/astroid/manager.py\", line 29, in <module>\r\n    from astroid.interpreter._import import spec\r\n  File \"/usr/lib/python3.9/site-packages/astroid/interpreter/_import/spec.py\", line 29, in <module>\r\n    from . import util\r\n  File \"/usr/lib/python3.9/site-packages/astroid/interpreter/_import/util.py\", line 4, in <module>\r\n    import pkg_resources\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 3257, in <module>\r\n    def _initialize_master_working_set():\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 3240, in _call_aside\r\n    f(*args, **kwargs)\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 3269, in _initialize_master_working_set\r\n    working_set = WorkingSet._build_master()\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 584, in _build_master\r\n    return cls._build_from_requirements(__requires__)\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 597, in _build_from_requirements\r\n    dists = ws.resolve(reqs, Environment())\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 785, in resolve\r\n    raise DistributionNotFound(req, requirers)\r\npkg_resources.DistributionNotFound: The 'lazy_object_proxy>=1.4.0' distribution was not found and is required by astroid\r\n\n@drfunjohn thanks for your report.\r\n@chiefnoah and @limburgher can you open separate issues with a clear reproducer?\r\nThanks in advance\nDone, thanks! https://github.com/PyCQA/astroid/issues/897\r\n\n@drfunjohn i identified the faulty commit (cc3bfc5dc94062a582b7b3226598f09d7ec7044e). I am looking for a patch.\nWow, thanks for quick response.\nYou are welcome but the patch seems tricky...\n@drfunjohn  i reverted the faulty commit in #901. I am the author of this commit. It was a try to improve the inference of `numpy` objects.\r\nApologies for the regression you faced.\n\n",
  "base_commit": "0f97f79c0aa50ed0506c09db729f906450b37652",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/ac0d01e5f0fcc5bc58bf31e5d95fd08dfa35a118",
    "https://github.com/pylint-dev/astroid/commit/4b1aefcfda6b2de4b86fd6d2b813cc47008cce7a",
    "https://github.com/pylint-dev/astroid/commit/6f885833bc27a5f2ac6555d75cdb0786fa74b08a",
    "https://github.com/pylint-dev/astroid/commit/aecfb37fcaadff8cb346619bd27bfafd1e347f08",
    "https://github.com/pylint-dev/astroid/commit/33c8c193f93e2c6c68d9398893e3a08e2d6f33b7"
  ],
  "created_at": "2021-02-17T11:37:55Z",
  "hints_text": "I'm seeing similar 2.5-related issues with Enum subclasses. Particularly, `Enum.__members__.items()`. Pylint complains about `__members__` have not member `items` which is incorrect.\nWith pylint 2.6.2, and astroid 2.4.2, everything is fine. With astroid 2.5:\r\n\r\n(note lazy_object_proxy 1.5.2 is present)\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 582, in _build_master\r\n    ws.require(__requires__)\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 899, in require\r\n    needed = self.resolve(parse_requirements(requirements))\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 790, in resolve\r\n    raise VersionConflict(dist, req).with_context(dependent_req)\r\npkg_resources.ContextualVersionConflict: (lazy-object-proxy 0.0.0 (/usr/lib64/python3.9/site-packages), Requirement.parse('lazy_object_proxy>=1.4.0'), {'astroid'})\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/bin/pylint-3\", line 33, in <module>\r\n    sys.exit(load_entry_point('pylint==2.6.2', 'console_scripts', 'pylint')())\r\n  File \"/usr/lib/python3.9/site-packages/pylint/__init__.py\", line 19, in run_pylint\r\n    from pylint.lint import Run as PylintRun\r\n  File \"/usr/lib/python3.9/site-packages/pylint/lint/__init__.py\", line 75, in <module>\r\n    from pylint.lint.check_parallel import check_parallel\r\n  File \"/usr/lib/python3.9/site-packages/pylint/lint/check_parallel.py\", line 7, in <module>\r\n    from pylint import reporters\r\n  File \"/usr/lib/python3.9/site-packages/pylint/reporters/__init__.py\", line 24, in <module>\r\n    from pylint import utils\r\n  File \"/usr/lib/python3.9/site-packages/pylint/utils/__init__.py\", line 47, in <module>\r\n    from pylint.utils.ast_walker import ASTWalker\r\n  File \"/usr/lib/python3.9/site-packages/pylint/utils/ast_walker.py\", line 6, in <module>\r\n    from astroid import nodes\r\n  File \"/usr/lib/python3.9/site-packages/astroid/__init__.py\", line 66, in <module>\r\n    from astroid.nodes import *\r\n  File \"/usr/lib/python3.9/site-packages/astroid/nodes.py\", line 23, in <module>\r\n    from astroid.node_classes import (\r\n  File \"/usr/lib/python3.9/site-packages/astroid/node_classes.py\", line 44, in <module>\r\n    from astroid import bases\r\n  File \"/usr/lib/python3.9/site-packages/astroid/bases.py\", line 36, in <module>\r\n    MANAGER = manager.AstroidManager()\r\n  File \"/usr/lib/python3.9/site-packages/astroid/util.py\", line 27, in <lambda>\r\n    lambda: importlib.import_module(\".\" + module_name, \"astroid\")\r\n  File \"/usr/lib64/python3.9/importlib/__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"/usr/lib/python3.9/site-packages/astroid/manager.py\", line 29, in <module>\r\n    from astroid.interpreter._import import spec\r\n  File \"/usr/lib/python3.9/site-packages/astroid/interpreter/_import/spec.py\", line 29, in <module>\r\n    from . import util\r\n  File \"/usr/lib/python3.9/site-packages/astroid/interpreter/_import/util.py\", line 4, in <module>\r\n    import pkg_resources\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 3257, in <module>\r\n    def _initialize_master_working_set():\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 3240, in _call_aside\r\n    f(*args, **kwargs)\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 3269, in _initialize_master_working_set\r\n    working_set = WorkingSet._build_master()\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 584, in _build_master\r\n    return cls._build_from_requirements(__requires__)\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 597, in _build_from_requirements\r\n    dists = ws.resolve(reqs, Environment())\r\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 785, in resolve\r\n    raise DistributionNotFound(req, requirers)\r\npkg_resources.DistributionNotFound: The 'lazy_object_proxy>=1.4.0' distribution was not found and is required by astroid\r\n\n@drfunjohn thanks for your report.\r\n@chiefnoah and @limburgher can you open separate issues with a clear reproducer?\r\nThanks in advance\nDone, thanks! https://github.com/PyCQA/astroid/issues/897\r\n\n@drfunjohn i identified the faulty commit (cc3bfc5dc94062a582b7b3226598f09d7ec7044e). I am looking for a patch.\nWow, thanks for quick response.\nYou are welcome but the patch seems tricky...\n\n",
  "instance_id": "pylint-dev__astroid-901",
  "issue_numbers": [
    895
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex 2c454cb8df..519fa249f3 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -2,6 +2,15 @@\n astroid's ChangeLog\n ===================\n \n+What's New in astroid 2.5.1?\n+============================\n+Release Date: TBA\n+\n+* The ``context.path`` is reverted to a set because otherwise it leds to false positives \n+  for non `numpy` functions.\n+\n+  Closes #895 #899\n+\n What's New in astroid 2.5?\n ============================\n Release Date: 2021-02-15\ndiff --git a/astroid/context.py b/astroid/context.py\nindex 27d1897f50..b667f8c2cd 100644\n--- a/astroid/context.py\n+++ b/astroid/context.py\n@@ -30,10 +30,8 @@ class InferenceContext:\n         \"extra_context\",\n     )\n \n-    maximum_path_visit = 3\n-\n     def __init__(self, path=None, inferred=None):\n-        self.path = path or dict()\n+        self.path = path or set()\n         \"\"\"\n         :type: set(tuple(NodeNG, optional(str)))\n \n@@ -90,10 +88,10 @@ def push(self, node):\n         Allows one to see if the given node has already\n         been looked at for this inference context\"\"\"\n         name = self.lookupname\n-        if self.path.get((node, name), 0) >= self.maximum_path_visit:\n+        if (node, name) in self.path:\n             return True\n \n-        self.path[(node, name)] = self.path.setdefault((node, name), 0) + 1\n+        self.path.add((node, name))\n         return False\n \n     def clone(self):\n@@ -111,7 +109,7 @@ def clone(self):\n \n     @contextlib.contextmanager\n     def restore_path(self):\n-        path = dict(self.path)\n+        path = set(self.path)\n         yield\n         self.path = path\n \n",
  "problem_statement": "Unexpected error from pylint after upgrade to astroid 2.5.\n### Steps to reproduce\r\nastroid 2.5\r\npylint 2.6.0\r\nelasticsearch 7.10.1\r\npython 3.7.3\r\n```\r\nfrom elasticsearch import Elasticsearch\r\nes = Elasticsearch([\"test\"])\r\nes.indices.delete(index=\"test\", ignore=[400, 404])\r\n```\r\n1.  run pylint\r\n\r\n### Current behavior\r\nline 3 >>> E1123: Unexpected keyword argument 'ignore' in method call (unexpected-keyword-arg)\r\n\r\n### Expected behavior\r\nastroid 2.4.2: no error from pylint\r\n\n",
  "pull_number": 901,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/unittest_brain_numpy_core_umath.py b/tests/unittest_brain_numpy_core_umath.py\nindex f384ea2539..593c9f89f9 100644\n--- a/tests/unittest_brain_numpy_core_umath.py\n+++ b/tests/unittest_brain_numpy_core_umath.py\n@@ -226,9 +226,11 @@ def test_numpy_core_umath_functions_return_type(self):\n             with self.subTest(typ=func_):\n                 inferred_values = list(self._inferred_numpy_func_call(func_))\n                 self.assertTrue(\n-                    len(inferred_values) == 1,\n+                    len(inferred_values) == 1\n+                    or len(inferred_values) == 2\n+                    and inferred_values[-1].pytype() is util.Uninferable,\n                     msg=\"Too much inferred values ({}) for {:s}\".format(\n-                        inferred_values, func_\n+                        inferred_values[-1].pytype(), func_\n                     ),\n                 )\n                 self.assertTrue(\ndiff --git a/tests/unittest_inference.py b/tests/unittest_inference.py\nindex 55bbe9e348..edb755c188 100644\n--- a/tests/unittest_inference.py\n+++ b/tests/unittest_inference.py\n@@ -1301,7 +1301,7 @@ def get_context_data(self, **kwargs):\n         result = node.inferred()\n         assert len(result) == 2\n         assert isinstance(result[0], nodes.Dict)\n-        assert isinstance(result[1], nodes.Dict)\n+        assert result[1] is util.Uninferable\n \n     def test_python25_no_relative_import(self):\n         ast = resources.build_file(\"data/package/absimport.py\")\n@@ -3686,8 +3686,7 @@ def __getitem__(self, name):\n         flow = AttributeDict()\n         flow['app'] = AttributeDict()\n         flow['app']['config'] = AttributeDict()\n-        flow['app']['config']['doffing'] = AttributeDict()\n-        flow['app']['config']['doffing']['thinkto'] = AttributeDict() #@\n+        flow['app']['config']['doffing'] = AttributeDict() #@\n         \"\"\"\n         )\n         self.assertIsNone(helpers.safe_infer(ast_node.targets[0]))\ndiff --git a/tests/unittest_regrtest.py b/tests/unittest_regrtest.py\nindex eeedd35327..042c97f098 100644\n--- a/tests/unittest_regrtest.py\n+++ b/tests/unittest_regrtest.py\n@@ -99,7 +99,7 @@ def test_numpy_crash(self):\n         astroid = builder.string_build(data, __name__, __file__)\n         callfunc = astroid.body[1].value.func\n         inferred = callfunc.inferred()\n-        self.assertEqual(len(inferred), 1)\n+        self.assertEqual(len(inferred), 2)\n \n     def test_nameconstant(self):\n         # used to fail for Python 3.4\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/0f97f79c0aa50ed0506c09db729f906450b37652"
}