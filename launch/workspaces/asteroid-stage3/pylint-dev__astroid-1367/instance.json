{
  "all_hints_text": "Sorry for missing this issue. I think it has been fixed in astroid 2.6.5 (https://github.com/PyCQA/astroid/commit/e432bd2dcffa61cfa55b00fb76009eae0f577120), do you confirm @gergelypolonkai ?\nI will check tomorrow morning (Central Europe time); i remember having it with 2.6.4, but don\u02bct remember if i tried 2.6.5 at all yet.\nNo, it seems we have also bumped into this using 2.6.5. Attached is the CI output with 2.6.5\r\n\r\n[astroid-error.log](https://github.com/PyCQA/astroid/files/6905066/astroid-error.log)\r\n\n@gergelypolonkai I'd like to investigate this but will probably need some help.\r\n\r\nYou probably still can't give any reproducible code right? I would be helpful if you could tell me what the `ImportFrom` on line 52 is that the stacktrace is referring to. Is that `import re`?\r\n\r\nAdditionally it would be helpful if we could determine what `name` we're trying to resolve here. If you could enter your site-packages and apply to this diff to `astroid` we could see what names lead to the exception being thrown:\r\n```diff\r\ndiff --git a/astroid/mixins.py b/astroid/mixins.py\r\nindex 097fd1ea4..e69d4fcef 100644\r\n--- a/astroid/mixins.py\r\n+++ b/astroid/mixins.py\r\n@@ -119,6 +119,9 @@ class ImportFromMixin(FilterStmtsMixin):\r\n                 _asname = name\r\n             if asname == _asname:\r\n                 return name\r\n+        print(\"SELF:\", self)\r\n+        print(\"ASNAME:\", asname)\r\n+        print(\"NAMES:\", self.names)\r\n         raise AttributeInferenceError(\r\n             \"Could not find original name for {attribute} in {target!r}\",\r\n             target=self,\r\n```\r\nYou can use `pip show astroid` to see the location of `astroid`.\nNo, as it happens in our company-internal code base, so it would be complicated to give access; I\u2019m continuously trying to reproduce it in one of my open source repos, but it hasn\u2019t happened yet.\r\n\r\nOn line 52 we import an internal module (`from .i18n import babel, setup_translations`); `re` is not imported anywhere in this module. At the end of the stack trace there\u2019s another import reference shown as `l.4`; if that line 4 is from the imported module (`i18n`), then it\u2019s also not `re` but `from flask_login import current_user`.\r\n\r\nBUT at the end, the culprit seems to be `re`. After applying your patch, i get this:\r\n\r\n```\r\nSELF: Import(names=[('re', None)])\r\nASNAME: items\r\nNAMES: [('re', None)]\r\n```\r\n\r\nHow we got there beats me, though, as even our `i18n` module doesn\u2019t import `re` directly.\nHmm this will be very hard to reproduce. I only have some slight hints which don't really form a coherent theory yet.\r\n\r\nBecause of the print of `self` we know that `real_name` is being called from this function:\r\nhttps://github.com/PyCQA/astroid/blob/9363c34934f94124f4867caf1bdf8f6755201ccd/astroid/inference.py#L261-L273\r\n\r\n`name` is thus the `lookupname` attribute of the context. Seeing as this starts with a `ImportFrom` node it is likely that it is being set in this function on L299. Note that `name` itself is set on L288 by `real_name` again:\r\nhttps://github.com/PyCQA/astroid/blob/9363c34934f94124f4867caf1bdf8f6755201ccd/astroid/inference.py#L281-L305\r\n\r\nhttps://github.com/PyCQA/astroid/blob/9363c34934f94124f4867caf1bdf8f6755201ccd/astroid/mixins.py#L112-L126\r\nIn `real_name` we're splitting on `.`. Based on the fact that `name` or `lookupname` ends up being `items`. I wonder if we're encountering a `dict.items()` somewhere. Can something be imported as a `dict`? \r\n\r\n------\r\n\r\nIf you're up for it, we could try another diff:\r\n```diff\r\ndiff --git a/astroid/mixins.py b/astroid/mixins.py\r\nindex 097fd1ea4..3d4679d37 100644\r\n--- a/astroid/mixins.py\r\n+++ b/astroid/mixins.py\r\n@@ -91,6 +91,8 @@ class ImportFromMixin(FilterStmtsMixin):\r\n \r\n     def do_import_module(self, modname=None):\r\n         \"\"\"return the ast for a module whose name is <modname> imported by <self>\"\"\"\r\n+        print(\"SELF:\", self)\r\n+        print(\"MODNAME:\", modname)\r\n         # handle special case where we are on a package node importing a module\r\n         # using the same name as the package, which may end in an infinite loop\r\n         # on relative imports\r\n```\r\n\r\nJust to double check what import statement is actually failing.  Based on the stacktrace this is where we actually enter `astroid` from `pylint` so that should hopefully bring us somewhat closer to the issue.\r\n\r\n\nOK, this on is *big*; the output is 479kbytes. `items` only appears in the stack trace, not before, not after it.\nWhat's the `modname` in the list print statement? `do_import_module` is called quite a bit (probably) when `astroid` is starting up, but I think the last call to `do_import_module` (and thus the last print of `MODNAME: ...`) should be relevant for us.\n```\r\nSELF: ImportFrom(modname='enum',\r\n           names=[('Enum', None), ('unique', None)],\r\n           level=None)\r\nMODNAME: None\r\nSELF: Traceback (most recent call last):\r\n[\u2026]\r\nastroid.exceptions.AttributeInferenceError: Could not find original name for items in <Import l.5 at 0x7f5eef3e53a0>\r\nImportFrom(modname='enum',\r\n           names=[('Enum', None), ('unique', None)],\r\n           level=None)\r\nMODNAME: None\r\n```\r\n\r\n(Note that since i reported the issue line numbers changed, hence the change from the original `l.4` to `l.5`)\r\n\r\nAlso, since then i found the offending(?) `import re` in `app.models` which is imported directly from `app.i18n`.\nDoes gripping for: `from enum import Enum, unique` return anything?\r\nBased on that `ImportFrom` that should be the offending line I think?\r\n\r\nAgain, the following diff and the last printed results might be interesting:\r\n```diff\r\ndiff --git a/astroid/builder.py b/astroid/builder.py\r\nindex 273c46e33..85827322c 100644\r\n--- a/astroid/builder.py\r\n+++ b/astroid/builder.py\r\n@@ -167,6 +167,9 @@ class AstroidBuilder(raw_building.InspectBuilder):\r\n                     module.future_imports.add(symbol)\r\n             self.add_from_names_to_locals(from_node)\r\n         # handle delayed assattr nodes\r\n+        print(\"MODULE:\", module)\r\n+        print(\"ASSATTR:\", module._delayed_assattr)\r\n         for delayed in module._delayed_assattr:\r\n             self.delayed_assattr(delayed)\r\n ```\r\n`self.delayed_assattr` starts calling inference functions from which point we start creating context and thus `lookupnames`.\n```\r\nMODULE: Module.app.i18n(name='app.i18n',\r\n                doc=None,\r\n                file='/home/polesz/Verkefni/python/gorgeous-tuatara/app/app/i18n.py',\r\n                path=[ '/home/polesz/Verkefni/python/gorgeous-tuatara/app/app/i18n.py'],\r\n                package=False,\r\n                pure_python=True,\r\n                future_imports=set(),\r\n                body=[ <ImportFrom l.1 at 0x7f5383d96460>,\r\n                  <ImportFrom l.3 at 0x7f5383d96490>,\r\n                  <ImportFrom l.4 at 0x7f5383d964f0>,\r\n                  <ImportFrom l.5 at 0x7f5383d96580>,\r\n                  <ImportFrom l.6 at 0x7f5383d962b0>,\r\n                  <ImportFrom l.7 at 0x7f5383d96520>,\r\n                  <ImportFrom l.8 at 0x7f5383d96550>,\r\n                  <ImportFrom l.10 at 0x7f5383d965b0>,\r\n                  <ImportFrom l.11 at 0x7f5383d96610>,\r\n                  <Assign l.13 at 0x7f5383d96640>,\r\n                  <FunctionDef.get_locale l.17 at 0x7f5383d85580>,\r\n                  <FunctionDef.setup_translatables l.77 at 0x7f5383d85610>])\r\nASSATTR: [<AssignAttr.locale l.88 at 0x7f5385f76640>]\r\n```\r\n\r\nand after this comes the backtrace, which is the end of the output.\nBased on this I'm making an (somewhat educated guess) is L88 defining an attribute that references something that gets imported on L5?\nL5 is\r\n\r\n```\r\nfrom flask_login import current_user\r\n```\r\n\r\nand L88 (and its relevant surrounding) is:\r\n\r\n```\r\n 84     for _, value in models.__dict__.items():\r\n 85         # comment\r\n 86         # comment\r\n 87         if isinstance(value, type) and issubclass(value, Translatable) and value != Translatable:\r\n 88             value.locale = app.config['BABEL_DEFAULT_LOCALE']\r\n```\nFor context, `models` is a module (imported on L11), and contains a lot of SQLAlchemy models, most of them imported from `models`\u2019 submodules.\nHmm, this looks like code that `astroid` might fail on. As in, `models.__dict__.items()` is probably not something we encounter very often. I think this might be due to how the `for` loop sets some parameters for the context, which might not get reset correctly when we start inferring the `app`. I ran into a similar problem with contexts not resetting correctly recently.\r\n\r\nI have to go now but I'll see tonight if I can connect some dots and see what is happening here. Thanks for all the help so far. I might come back with another `diff` but feel like we're close than we started a couple hours ago \ud83d\ude04 \nDon\u2019t ask what made me, but i tried a little change on my code and changed that `for` line like this:\r\n\r\n```\r\nfor value in models.__dict__.values():\r\n```\r\n\r\nAnd now the astroid error is gone. I checked if i install `gettext` as `_` as i do in some other modules, but this is not the case here, so it\u2019s *probably* not the underscore, but who knows after all this\u2026\nAlso, i still can\u2019t reproduce the problem:\r\n\r\n`__init__.py`:\r\n\r\n```\r\nfrom . import test\r\n```\r\n\r\n`test.py`:\r\n```\r\nfrom . import test2\r\n\r\ndef func():\r\n    for _, value in test2.__dict__.items():\r\n        value()\r\n```\r\n\r\n`test2.py`:\r\n```\r\ndef something():\r\n    pass\r\n```\r\n\r\nEven if i add an `import re` (your original theoretical culprit) here and there, it succeeds. So the problem lies probably much deeper than this.\nOne of the problems I'm running into now is that `_infer_stmts` was changed in between current release and the `astroid` you're working with.\r\nCould you try:\r\n```diff\r\ndiff --git a/astroid/bases.py b/astroid/bases.py\r\nindex 4b5114e12..0bd1f71a7 100644\r\n--- a/astroid/bases.py\r\n+++ b/astroid/bases.py\r\n@@ -139,6 +139,8 @@ class Proxy:\r\n \r\n def _infer_stmts(stmts, context, frame=None):\r\n     \"\"\"Return an iterator on statements inferred by each statement in *stmts*.\"\"\"\r\n+    print(\"STMTS:\", stmts)\r\n+    print(\"CONTEXT:\", context)\r\n     inferred = False\r\n     if context is not None:\r\n         name = context.lookupname\r\n```\r\n\r\nI can't get it to crash yet but I think a better representation of the crash is:\r\n`__init__.py`\r\n```python\r\nimport models\r\n\r\ndef func():\r\n    for _, value in models.__dict__.items():\r\n        if isinstance(value, type):\r\n            value.class_attribute += 1\r\n```\r\n\r\n`models.py`\r\n```python\r\nclass MyModel:\r\n    class_attribute = 1\r\n```\r\n\r\nWe need t assignment to `class_attribute` (`locale` in your example) to get the `delayed_assattr` call. After that it is trying to infer what `value` is based on statements. This is where it messes up, likely because of some code in `models.py`.\r\nI couldn't get it to fail yet.\r\nIs there an import on L5 in `models.py`? Perhaps L5 is referring to L5 in that file.\nI've made it crash \ud83c\udf89 \r\n\r\nReproducing code:\r\n`__init__.py`\r\n```python\r\nimport models\r\n\r\ndef func():\r\n    for _, value in models.__dict__.items():\r\n        if isinstance(value, type):\r\n            value.class_attribute += 1\r\n```\r\n\r\n`models.py`\r\n```python\r\nimport re\r\nclass MyModel:\r\n    class_attribute = 1\r\n```\r\n\n@gergelypolonkai You'll be happy to know that I think I found a fix and created a PR that seems to pass CI.\r\n\r\nThis should be available in `2.10` \ud83d\ude04 \nOh, that sounds great! I'll revert my workaround in the company repo later today and check it with master, just in case ;)\r\n\r\nThanks for fixing it!\n\n",
  "base_commit": "e00545978158ced5bacf8fede365efd0d690d320",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/3669736533a8d51eab36b4481e09b613e9552047"
  ],
  "created_at": "2022-01-20T21:27:53Z",
  "hints_text": "Sorry for missing this issue. I think it has been fixed in astroid 2.6.5 (https://github.com/PyCQA/astroid/commit/e432bd2dcffa61cfa55b00fb76009eae0f577120), do you confirm @gergelypolonkai ?\nI will check tomorrow morning (Central Europe time); i remember having it with 2.6.4, but don\u02bct remember if i tried 2.6.5 at all yet.\nNo, it seems we have also bumped into this using 2.6.5. Attached is the CI output with 2.6.5\r\n\r\n[astroid-error.log](https://github.com/PyCQA/astroid/files/6905066/astroid-error.log)\r\n\n@gergelypolonkai I'd like to investigate this but will probably need some help.\r\n\r\nYou probably still can't give any reproducible code right? I would be helpful if you could tell me what the `ImportFrom` on line 52 is that the stacktrace is referring to. Is that `import re`?\r\n\r\nAdditionally it would be helpful if we could determine what `name` we're trying to resolve here. If you could enter your site-packages and apply to this diff to `astroid` we could see what names lead to the exception being thrown:\r\n```diff\r\ndiff --git a/astroid/mixins.py b/astroid/mixins.py\r\nindex 097fd1ea4..e69d4fcef 100644\r\n--- a/astroid/mixins.py\r\n+++ b/astroid/mixins.py\r\n@@ -119,6 +119,9 @@ class ImportFromMixin(FilterStmtsMixin):\r\n                 _asname = name\r\n             if asname == _asname:\r\n                 return name\r\n+        print(\"SELF:\", self)\r\n+        print(\"ASNAME:\", asname)\r\n+        print(\"NAMES:\", self.names)\r\n         raise AttributeInferenceError(\r\n             \"Could not find original name for {attribute} in {target!r}\",\r\n             target=self,\r\n```\r\nYou can use `pip show astroid` to see the location of `astroid`.\nNo, as it happens in our company-internal code base, so it would be complicated to give access; I\u2019m continuously trying to reproduce it in one of my open source repos, but it hasn\u2019t happened yet.\r\n\r\nOn line 52 we import an internal module (`from .i18n import babel, setup_translations`); `re` is not imported anywhere in this module. At the end of the stack trace there\u2019s another import reference shown as `l.4`; if that line 4 is from the imported module (`i18n`), then it\u2019s also not `re` but `from flask_login import current_user`.\r\n\r\nBUT at the end, the culprit seems to be `re`. After applying your patch, i get this:\r\n\r\n```\r\nSELF: Import(names=[('re', None)])\r\nASNAME: items\r\nNAMES: [('re', None)]\r\n```\r\n\r\nHow we got there beats me, though, as even our `i18n` module doesn\u2019t import `re` directly.\n\n",
  "instance_id": "pylint-dev__astroid-1367",
  "issue_numbers": [
    1085
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex 3bb23e2de8..0127cbd898 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -7,6 +7,11 @@ What's New in astroid 2.10.0?\n Release date: TBA\n \n \n+* Fixed crash when trying to infer ``items()`` on the ``__dict__``\n+  attribute of an imported module.\n+\n+  Closes #1085\n+\n What's New in astroid 2.9.4?\n ============================\n Release date: TBA\ndiff --git a/astroid/inference.py b/astroid/inference.py\nindex 74f04dd96a..f1b50a870b 100644\n--- a/astroid/inference.py\n+++ b/astroid/inference.py\n@@ -317,6 +317,8 @@ def infer_attribute(self, context=None):\n \n         if not context:\n             context = InferenceContext()\n+        else:\n+            context = copy_context(context)\n \n         old_boundnode = context.boundnode\n         try:\n",
  "problem_statement": "AttributeInferenceError: Could not find original name for items in ``Import``\n### Steps to reproduce\r\n\r\nCannot reproduce outside of our closed-source repository yet; help appreciated on that.\r\n\r\n### Current behavior\r\n\r\nPylint fails with a backtrace.\r\n\r\nBased on what i found so far the import statement in question is `import re`, a Python builtin. If i leave nothing but that line in that file, the error persists. If i run the same version of Pylint/astroid in a completely separate repo with only one file with only that single import line, Pylint works as expected.\r\n\r\n### Expected behavior\r\n\r\nSince earlier versions of Pylint and astroid work as expected on the very same code base, \r\n\r\n### `python -c \"from astroid import __pkginfo__; print(__pkginfo__.version)\"` output\r\n\r\n2.6.2\r\n\r\nPython versions i tested with are 3.6.10 and 3.9.5. Pylint version i use is 2.9.3.\r\n\r\n### Backtrace\r\n\r\n```\r\nException on node <ImportFrom l.52 at 0x7fbb6d0ba370> in file '/home/polesz/Verkefni/python/gorgeous-tuatara/app/app/__init__.py'\r\nTraceback (most recent call last):\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/bin/pylint\", line 8, in <module>\r\n    sys.exit(run_pylint())\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/__init__.py\", line 24, in run_pylint\r\n    PylintRun(sys.argv[1:])\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/lint/run.py\", line 384, in __init__\r\n    linter.check(args)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/lint/pylinter.py\", line 973, in check\r\n    self._check_files(\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/lint/pylinter.py\", line 1007, in _check_files\r\n    self._check_file(get_ast, check_astroid_module, name, filepath, modname)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/lint/pylinter.py\", line 1033, in _check_file\r\n    check_astroid_module(ast_node)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/lint/pylinter.py\", line 1170, in check_astroid_module\r\n    retval = self._check_astroid_module(\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/lint/pylinter.py\", line 1215, in _check_astroid_module\r\n    walker.walk(ast_node)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/utils/ast_walker.py\", line 77, in walk\r\n    self.walk(child)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/utils/ast_walker.py\", line 74, in walk\r\n    callback(astroid)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/checkers/imports.py\", line 551, in visit_importfrom\r\n    imported_module = self._get_imported_module(node, basename)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/pylint/checkers/imports.py\", line 808, in _get_imported_module\r\n    return importnode.do_import_module(modname)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/mixins.py\", line 101, in do_import_module\r\n    return mymodule.import_module(\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/scoped_nodes.py\", line 686, in import_module\r\n    return AstroidManager().ast_from_module_name(absmodname)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/manager.py\", line 205, in ast_from_module_name\r\n    return self.ast_from_file(found_spec.location, modname, fallback=False)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/manager.py\", line 116, in ast_from_file\r\n    return AstroidBuilder(self).file_build(filepath, modname)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/builder.py\", line 135, in file_build\r\n    return self._post_build(module, encoding)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/builder.py\", line 155, in _post_build\r\n    self.delayed_assattr(delayed)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/builder.py\", line 225, in delayed_assattr\r\n    for inferred in node.expr.infer():\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/node_classes.py\", line 353, in infer\r\n    yield from self._infer(context, **kwargs)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/decorators.py\", line 136, in raise_if_nothing_inferred\r\n    yield next(generator)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/decorators.py\", line 100, in wrapped\r\n    res = next(generator)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/bases.py\", line 144, in _infer_stmts\r\n    for inferred in stmt.infer(context=context):\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/node_classes.py\", line 367, in infer\r\n    for i, result in enumerate(generator):\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/decorators.py\", line 136, in raise_if_nothing_inferred\r\n    yield next(generator)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/decorators.py\", line 100, in wrapped\r\n    res = next(generator)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/bases.py\", line 144, in _infer_stmts\r\n    for inferred in stmt.infer(context=context):\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/node_classes.py\", line 367, in infer\r\n    for i, result in enumerate(generator):\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/decorators.py\", line 136, in raise_if_nothing_inferred\r\n    yield next(generator)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/decorators.py\", line 100, in wrapped\r\n    res = next(generator)\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/inference.py\", line 258, in infer_import\r\n    yield self.do_import_module(self.real_name(name))\r\n  File \"/home/polesz/.cache/pypoetry/virtualenvs/app-K022m1iN-py3.9/lib/python3.9/site-packages/astroid/mixins.py\", line 120, in real_name\r\n    raise AttributeInferenceError(\r\nastroid.exceptions.AttributeInferenceError: Could not find original name for items in <Import l.4 at 0x7fbb665a5be0>\r\n```\n",
  "pull_number": 1367,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/testdata/python3/data/module_dict_items_call/models.py b/tests/testdata/python3/data/module_dict_items_call/models.py\nnew file mode 100644\nindex 0000000000..212bc011b5\n--- /dev/null\n+++ b/tests/testdata/python3/data/module_dict_items_call/models.py\n@@ -0,0 +1,5 @@\n+import re\n+\n+\n+class MyModel:\n+    class_attribute = 1\ndiff --git a/tests/testdata/python3/data/module_dict_items_call/test.py b/tests/testdata/python3/data/module_dict_items_call/test.py\nnew file mode 100644\nindex 0000000000..4a52b18e97\n--- /dev/null\n+++ b/tests/testdata/python3/data/module_dict_items_call/test.py\n@@ -0,0 +1,7 @@\n+import models\n+\n+\n+def func():\n+    for _, value in models.__dict__.items():\n+        if isinstance(value, type):\n+            value.class_attribute += 1\ndiff --git a/tests/unittest_inference.py b/tests/unittest_inference.py\nindex 0133c78797..d2de2b5b75 100644\n--- a/tests/unittest_inference.py\n+++ b/tests/unittest_inference.py\n@@ -48,6 +48,7 @@\n import unittest\n from abc import ABCMeta\n from functools import partial\n+from pathlib import Path\n from typing import Any, Callable, Dict, List, Tuple, Union\n from unittest.mock import patch\n \n@@ -88,6 +89,7 @@ def get_node_of_class(start_from: nodes.FunctionDef, klass: type) -> nodes.Attri\n \n EXC_MODULE = \"builtins\"\n BOOL_SPECIAL_METHOD = \"__bool__\"\n+DATA_DIR = Path(__file__).parent / \"testdata\" / \"python3\" / \"data\"\n \n \n class InferenceUtilsTest(unittest.TestCase):\n@@ -1732,8 +1734,7 @@ def __init__(self):\n         \"\"\"\n         ast = extract_node(code, __name__)\n         expr = ast.func.expr\n-        with pytest.raises(InferenceError):\n-            next(expr.infer())\n+        self.assertIs(next(expr.infer()), util.Uninferable)\n \n     def test_tuple_builtin_inference(self) -> None:\n         code = \"\"\"\n@@ -6584,5 +6585,13 @@ def test_relative_imports_init_package() -> None:\n     )\n \n \n+def test_inference_of_items_on_module_dict() -> None:\n+    \"\"\"Crash test for the inference of items() on a module's dict attribute.\n+\n+    Originally reported in https://github.com/PyCQA/astroid/issues/1085\n+    \"\"\"\n+    builder.file_build(str(DATA_DIR / \"module_dict_items_call\" / \"test.py\"), \"models\")\n+\n+\n if __name__ == \"__main__\":\n     unittest.main()\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/e00545978158ced5bacf8fede365efd0d690d320"
}