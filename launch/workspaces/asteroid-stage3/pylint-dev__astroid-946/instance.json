{
  "all_hints_text": "Minimal case:\r\n\r\n```python\r\nclass Example:\r\n    def func(self):\r\n        pass\r\n\r\n\r\nwhatthe = object()\r\nwhatthe.func = None\r\n\r\nex = Example()\r\nex.func()   # false-positive: not-callable\r\n```\nNot caused by 78d5537, just revealed by it. `typing` imported `collections`, `collections.OrderedDict` had an ambiguously inferred case that was previously broken by failure with positional-only arguments which was fixed in 78d5537.\n\n",
  "base_commit": "2c109eec6fe3f972c6e8c637fe956431a0d7685c",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/957c832d049708d5e3a8e47c13231afe38914b39",
    "https://github.com/pylint-dev/astroid/commit/09558a0743c6130b472f6b4ea1c2a44fdb5a3e77",
    "https://github.com/pylint-dev/astroid/commit/5b9916b67c4d75b3ed4d33c1eb93f4197da0d16c",
    "https://github.com/pylint-dev/astroid/commit/96d0496b422b264506629d8c2c0c4ec4a8f18b1d"
  ],
  "created_at": "2021-04-13T12:30:06Z",
  "hints_text": "Minimal case:\r\n\r\n```python\r\nclass Example:\r\n    def func(self):\r\n        pass\r\n\r\n\r\nwhatthe = object()\r\nwhatthe.func = None\r\n\r\nex = Example()\r\nex.func()   # false-positive: not-callable\r\n```\nNot caused by 78d5537, just revealed by it. `typing` imported `collections`, `collections.OrderedDict` had an ambiguously inferred case that was previously broken by failure with positional-only arguments which was fixed in 78d5537.\n\n",
  "instance_id": "pylint-dev__astroid-946",
  "issue_numbers": [
    945
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex b4af947daa..12fae5ceab 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -6,6 +6,15 @@ What's New in astroid 2.6.0?\n ============================\n Release Date: TBA\n \n+* Do not set instance attributes on builtin object()\n+\n+ Closes #945\n+ Closes PyCQA/pylint#4232\n+ Closes PyCQA/pylint#4221\n+ Closes PyCQA/pylint#3970\n+ Closes PyCQA/pylint#3595\n+\n+\n What's New in astroid 2.5.6?\n ============================\n Release Date: 2021-04-25\ndiff --git a/astroid/builder.py b/astroid/builder.py\nindex 6a7f79ced0..4a066ee836 100644\n--- a/astroid/builder.py\n+++ b/astroid/builder.py\n@@ -67,7 +67,7 @@ def _can_assign_attr(node, attrname):\n     else:\n         if slots and attrname not in {slot.value for slot in slots}:\n             return False\n-    return True\n+    return node.qname() != \"builtins.object\"\n \n \n class AstroidBuilder(raw_building.InspectBuilder):\n",
  "problem_statement": "Delayed attribute assignment to object() may cause incorrect inference of instance attributes\n@cdce8p: `aiohttp` and `VLCTelnet` turned out to be red herrings. This case fails on current stable versions:\r\n\r\n```python\r\nclass Example:\r\n    def prev(self):\r\n        pass\r\n    def next(self):\r\n        pass\r\n    def other(self):\r\n        pass\r\n\r\n\r\nex = Example()\r\nex.other()  # no warning\r\nex.prev()   # no warning\r\nex.next()   # no warning\r\n\r\nimport typing\r\n\r\nex.other()  # no warning\r\nex.prev()   # false-positive: not-callable\r\nex.next()   # false-positive: not-callable\r\n```\r\n\r\n_Originally posted by @nelfin in https://github.com/PyCQA/astroid/issues/927#issuecomment-818626368_\r\n\r\nI've bisected this down to 78d5537. Pylint 2.3.1 passes this case with 20a7ae5 and fails with 78d5537\n",
  "pull_number": 946,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/unittest_builder.py b/tests/unittest_builder.py\nindex a48d341999..ce9abf9af0 100644\n--- a/tests/unittest_builder.py\n+++ b/tests/unittest_builder.py\n@@ -28,7 +28,7 @@\n \n import pytest\n \n-from astroid import builder, exceptions, manager, nodes, test_utils, util\n+from astroid import Instance, builder, exceptions, manager, nodes, test_utils, util\n \n from . import resources\n \n@@ -476,6 +476,53 @@ def A_assign_type(self):\n         self.assertIn(\"assign_type\", lclass.locals)\n         self.assertIn(\"type\", lclass.locals)\n \n+    def test_infer_can_assign_regular_object(self):\n+        mod = builder.parse(\n+            \"\"\"\n+            class A:\n+                pass\n+            a = A()\n+            a.value = \"is set\"\n+            a.other = \"is set\"\n+        \"\"\"\n+        )\n+        obj = list(mod.igetattr(\"a\"))\n+        self.assertEqual(len(obj), 1)\n+        obj = obj[0]\n+        self.assertIsInstance(obj, Instance)\n+        self.assertIn(\"value\", obj.instance_attrs)\n+        self.assertIn(\"other\", obj.instance_attrs)\n+\n+    def test_infer_can_assign_has_slots(self):\n+        mod = builder.parse(\n+            \"\"\"\n+            class A:\n+                __slots__ = ('value',)\n+            a = A()\n+            a.value = \"is set\"\n+            a.other = \"not set\"\n+        \"\"\"\n+        )\n+        obj = list(mod.igetattr(\"a\"))\n+        self.assertEqual(len(obj), 1)\n+        obj = obj[0]\n+        self.assertIsInstance(obj, Instance)\n+        self.assertIn(\"value\", obj.instance_attrs)\n+        self.assertNotIn(\"other\", obj.instance_attrs)\n+\n+    def test_infer_can_assign_no_classdict(self):\n+        mod = builder.parse(\n+            \"\"\"\n+            a = object()\n+            a.value = \"not set\"\n+        \"\"\"\n+        )\n+        obj = list(mod.igetattr(\"a\"))\n+        self.assertEqual(len(obj), 1)\n+        obj = obj[0]\n+        self.assertIsInstance(obj, Instance)\n+        self.assertNotIn(\"value\", obj.instance_attrs)\n+\n     def test_augassign_attr(self):\n         builder.parse(\n             \"\"\"\ndiff --git a/tests/unittest_scoped_nodes.py b/tests/unittest_scoped_nodes.py\nindex dd6102c6ff..9303f1c7eb 100644\n--- a/tests/unittest_scoped_nodes.py\n+++ b/tests/unittest_scoped_nodes.py\n@@ -1430,7 +1430,9 @@ class A:\n             pass\n         class B:\n             pass\n-        scope = object()\n+        class Scope:\n+            pass\n+        scope = Scope()\n         scope.A = A\n         scope.B = B\n         class C(scope.A, scope.B):\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/2c109eec6fe3f972c6e8c637fe956431a0d7685c"
}