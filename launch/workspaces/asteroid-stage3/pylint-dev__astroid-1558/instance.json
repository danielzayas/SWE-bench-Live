{
  "all_hints_text": "Haven't looked at this myself, but one user also reports this on the latest 3.8:\n\nhttps://github.com/PyCQA/astroid/commit/78a486dc7ecc2567b85ba9d4a85e20639ed71aad#commitcomment-73321532\n\nNot sure if that is the same bug or if it is actually valid, but that might help narrow this down?\nsee https://github.com/python/cpython/pull/28045\n> see [python/cpython#28045](https://github.com/python/cpython/pull/28045)\r\n\r\nThat looked promising. However, I did bisect it to https://github.com/python/cpython/pull/92202\r\nNeed to take a closer look tomorrow.\n\n",
  "base_commit": "fd102d45a3552c00d951a07b02c49d278a7a69a2",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/a12cf049401fc8936ee9f59f49e63e59ff7027d7"
  ],
  "created_at": "2022-05-13T21:19:34Z",
  "hints_text": "Haven't looked at this myself, but one user also reports this on the latest 3.8:\n\nhttps://github.com/PyCQA/astroid/commit/78a486dc7ecc2567b85ba9d4a85e20639ed71aad#commitcomment-73321532\n\nNot sure if that is the same bug or if it is actually valid, but that might help narrow this down?\nsee https://github.com/python/cpython/pull/28045\n> see [python/cpython#28045](https://github.com/python/cpython/pull/28045)\r\n\r\nThat looked promising. However, I did bisect it to https://github.com/python/cpython/pull/92202\r\nNeed to take a closer look tomorrow.\n\n",
  "instance_id": "pylint-dev__astroid-1558",
  "issue_numbers": [
    1551
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex c9d4dd844c..bd6ed51cda 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -25,6 +25,9 @@ Release date: TBA\n \n   Closes #1403\n \n+* Fix test for Python ``3.11``. In some instances ``err.__traceback__`` will\n+  be uninferable now.\n+\n What's New in astroid 2.11.6?\n =============================\n Release date: TBA\n",
  "problem_statement": "Test issue with 3.11\nManaged to track down the test issue we are seeing with `3.11.0b1` a bit. Seems like it's partially caused by another test case which is why I wasn't able to reproduce it locally at first. The following command can be used to recreate the issue\r\n\r\n```\r\npytest \\\r\n    tests/unittest_brain.py::ModuleExtenderTest::test_extension_modules \\\r\n    tests/unittest_object_model.py::ExceptionModelTest::test_valueerror_py3\r\n```\r\n\r\nIn particular it seems like the `unittest` module extender is partially responsible. Not sure though if it's a false positive or a real issue.\r\nhttps://github.com/PyCQA/astroid/blob/0bf711f84d2de55bf777b45cec2449ce776a669a/astroid/brain/brain_unittest.py#L28-L31\r\n\r\nSo far I haven't figured out what exactly is going on here. It must have been a change in `3.11.0b1` though since `3.11.0a7` was ok. Maybe you two have an idea @DanielNoord @jacobtylerwalls?\r\n\r\n/CC: @Pierre-Sassoulas\r\n\r\nhttps://docs.python.org/3.11/whatsnew/changelog.html#python-3-11-0-beta-1\n",
  "pull_number": 1558,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/unittest_object_model.py b/tests/unittest_object_model.py\nindex a9f9f1f1b9..3cf2e4aee3 100644\n--- a/tests/unittest_object_model.py\n+++ b/tests/unittest_object_model.py\n@@ -9,6 +9,7 @@\n \n import astroid\n from astroid import builder, nodes, objects, test_utils, util\n+from astroid.const import PY311_PLUS\n from astroid.exceptions import InferenceError\n \n try:\n@@ -530,7 +531,8 @@ def test():\n \n \n class ExceptionModelTest(unittest.TestCase):\n-    def test_valueerror_py3(self) -> None:\n+    @staticmethod\n+    def test_valueerror_py3() -> None:\n         ast_nodes = builder.extract_node(\n             \"\"\"\n         try:\n@@ -544,12 +546,21 @@ def test_valueerror_py3(self) -> None:\n         )\n         assert isinstance(ast_nodes, list)\n         args = next(ast_nodes[0].infer())\n-        self.assertIsInstance(args, astroid.Tuple)\n+        assert isinstance(args, astroid.Tuple)\n         tb = next(ast_nodes[1].infer())\n-        self.assertIsInstance(tb, astroid.Instance)\n-        self.assertEqual(tb.name, \"traceback\")\n-\n-        with self.assertRaises(InferenceError):\n+        # Python 3.11: If 'contextlib' is loaded, '__traceback__'\n+        # could be set inside '__exit__' method in\n+        # which case 'err.__traceback__' will be 'Uninferable'\n+        try:\n+            assert isinstance(tb, astroid.Instance)\n+            assert tb.name == \"traceback\"\n+        except AssertionError:\n+            if PY311_PLUS:\n+                assert tb == util.Uninferable\n+            else:\n+                raise\n+\n+        with pytest.raises(InferenceError):\n             next(ast_nodes[2].infer())\n \n     def test_syntax_error(self) -> None:\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/fd102d45a3552c00d951a07b02c49d278a7a69a2"
}