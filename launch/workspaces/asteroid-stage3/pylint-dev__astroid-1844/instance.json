{
  "all_hints_text": "\n\n",
  "base_commit": "04fad05603fab94776f31b8c7ef2785d4538133f",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/5883c65627abab06e3c2b10410dc50316cf001b9"
  ],
  "created_at": "2022-10-20T11:13:36Z",
  "hints_text": "\n\n",
  "instance_id": "pylint-dev__astroid-1844",
  "issue_numbers": [
    1843
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex 89cd00f015..2a17699e85 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -38,6 +38,9 @@ Release date: TBA\n \n   Refs PyCQA/pylint#7706\n \n+* Catch ``ValueError`` when indexing some builtin containers and sequences during inference.\n+\n+  Closes #1843\n \n What's New in astroid 2.12.12?\n ==============================\ndiff --git a/astroid/inference.py b/astroid/inference.py\nindex a71005540b..502e11b1df 100644\n--- a/astroid/inference.py\n+++ b/astroid/inference.py\n@@ -27,6 +27,7 @@\n     AstroidError,\n     AstroidIndexError,\n     AstroidTypeError,\n+    AstroidValueError,\n     AttributeInferenceError,\n     InferenceError,\n     NameInferenceError,\n@@ -441,6 +442,7 @@ def infer_subscript(\n             except (\n                 AstroidTypeError,\n                 AstroidIndexError,\n+                AstroidValueError,\n                 AttributeInferenceError,\n                 AttributeError,\n             ) as exc:\ndiff --git a/astroid/nodes/node_classes.py b/astroid/nodes/node_classes.py\nindex c9c79cc36c..4414d9ce17 100644\n--- a/astroid/nodes/node_classes.py\n+++ b/astroid/nodes/node_classes.py\n@@ -22,6 +22,7 @@\n from astroid.exceptions import (\n     AstroidIndexError,\n     AstroidTypeError,\n+    AstroidValueError,\n     InferenceError,\n     NoDefault,\n     ParentMissingError,\n@@ -234,6 +235,13 @@ def _container_getitem(instance, elts, index, context=None):\n             return new_cls\n         if isinstance(index, Const):\n             return elts[index.value]\n+    except ValueError as exc:\n+        raise AstroidValueError(\n+            message=\"Slice {index!r} cannot index container\",\n+            node=instance,\n+            index=index,\n+            context=context,\n+        ) from exc\n     except IndexError as exc:\n         raise AstroidIndexError(\n             message=\"Index {index!s} out of range\",\n@@ -2030,6 +2038,10 @@ def getitem(self, index, context=None):\n         try:\n             if isinstance(self.value, (str, bytes)):\n                 return Const(self.value[index_value])\n+        except ValueError as exc:\n+            raise AstroidValueError(\n+                f\"Could not index {self.value!r} with {index_value!r}\"\n+            ) from exc\n         except IndexError as exc:\n             raise AstroidIndexError(\n                 message=\"Index {index!r} out of range\",\n",
  "problem_statement": "Uncaught ValueError on inferring __getitem__ with nonsensical slices\n### Steps to reproduce\r\n\r\n```python\r\nimport astroid\r\nnode = astroid.extract_node(\"[][::0]\")\r\nprint(next(node.infer()))\r\n```\r\n\r\n### Current behavior\r\n\r\n```python\r\nTraceback (most recent call last):\r\n  File \"repro.py\", line 3, in <module>\r\n    print(next(node.infer()))\r\n  File \".../astroid/nodes/node_ng.py\", line 169, in infer\r\n    yield from self._infer(context=context, **kwargs)\r\n  File \".../astroid/decorators.py\", line 140, in raise_if_nothing_inferred\r\n    yield next(generator)\r\n  File \".../astroid/decorators.py\", line 109, in wrapped\r\n    for res in _func(node, context, **kwargs):\r\n  File \".../astroid/inference.py\", line 440, in infer_subscript\r\n    assigned = value.getitem(index_value, context)\r\n  File \".../astroid/nodes/node_classes.py\", line 3499, in getitem\r\n    return _container_getitem(self, self.elts, index, context=context)\r\n  File \".../astroid/nodes/node_classes.py\", line 232, in _container_getitem\r\n    new_cls.elts = elts[index_slice]\r\nValueError: slice step cannot be zero\r\n```\r\n\r\nOriginally spotted in `pylint` with a minimal reproducer like:\r\n\r\n```python\r\nfor _ in [][::0]:\r\n    pass\r\n```\r\n\r\n### Expected behavior\r\n\r\n`Uninferable`\r\n\r\n### `python -c \"from astroid import __pkginfo__; print(__pkginfo__.version)\"` output\r\n\r\n```\r\n(venv) $ python -c \"from astroid import __pkginfo__; print(__pkginfo__.version)\"\r\n2.13.0-dev0\r\n(venv) $ git rev-parse HEAD\r\n1a074cf66fc4fdb6714fac7afb14f9e7457cd704\r\n```\n",
  "pull_number": 1844,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/unittest_inference.py b/tests/unittest_inference.py\nindex 8ca10ca60f..12092be775 100644\n--- a/tests/unittest_inference.py\n+++ b/tests/unittest_inference.py\n@@ -5316,6 +5316,16 @@ def test_slice_inference_in_for_loops_not_working() -> None:\n         assert inferred == util.Uninferable\n \n \n+def test_slice_zero_step_does_not_raise_ValueError() -> None:\n+    node = extract_node(\"x = [][::0]; x\")\n+    assert next(node.infer()) == util.Uninferable\n+\n+\n+def test_slice_zero_step_on_str_does_not_raise_ValueError() -> None:\n+    node = extract_node('x = \"\"[::0]; x')\n+    assert next(node.infer()) == util.Uninferable\n+\n+\n def test_unpacking_starred_and_dicts_in_assignment() -> None:\n     node = extract_node(\n         \"\"\"\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/04fad05603fab94776f31b8c7ef2785d4538133f"
}