{
  "all_hints_text": "Thanks for the report, I can reproduce the issue.\n\n",
  "base_commit": "a8bde99124c4213c26fd92a4b287786e5f4829ed",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/a0d7601b6205a0c6167fdd73fc121e2acfb09856"
  ],
  "created_at": "2020-12-30T09:59:43Z",
  "hints_text": "Thanks for the report, I can reproduce the issue.\n\n",
  "instance_id": "pylint-dev__astroid-874",
  "issue_numbers": [
    819
  ],
  "language": "python",
  "patch": "diff --git a/ChangeLog b/ChangeLog\nindex 560544befa..144afdf8c1 100644\n--- a/ChangeLog\n+++ b/ChangeLog\n@@ -15,6 +15,10 @@ Release Date: TBA\n \n   Fixes PyCQA/pylint#3640\n \n+* Fix a bug for dunder methods inference of function objects\n+\n+  Fixes #819\n+\n * Fixes a bug in the signature of the ``ndarray.__or__`` method,\n   in the ``brain_numpy_ndarray.py`` module.\n \ndiff --git a/astroid/interpreter/objectmodel.py b/astroid/interpreter/objectmodel.py\nindex 3eca5722d4..ae48ac11da 100644\n--- a/astroid/interpreter/objectmodel.py\n+++ b/astroid/interpreter/objectmodel.py\n@@ -324,6 +324,7 @@ def infer_call_result(self, caller, context=None):\n                     doc=func.doc,\n                     lineno=func.lineno,\n                     col_offset=func.col_offset,\n+                    parent=func.parent,\n                 )\n                 # pylint: disable=no-member\n                 new_func.postinit(func.args, func.body, func.decorators, func.returns)\n",
  "problem_statement": "AttributeError: 'NoneType' object has no attribute 'frame'\n### Steps to reproduce\r\n1. Create reproduce.py with:\r\n```\r\nclass MyClass():\r\n    def fu(self, objects):\r\n        delitem = dict.__delitem__.__get__(self, dict)\r\n        for k in objects:\r\n            delitem(k)\r\n```\r\n2. Run pylint 2.5.3 on the file.\r\n\r\n### Current behavior\r\nException:\r\n```\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\lint\\run.py\", line 344, in __init__\r\n    linter.check(args)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\lint\\pylinter.py\", line 870, in check\r\n    self._check_files(\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\lint\\pylinter.py\", line 904, in _check_files\r\n    self._check_file(get_ast, check_astroid_module, name, filepath, modname)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\lint\\pylinter.py\", line 930, in _check_file\r\n    check_astroid_module(ast_node)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\lint\\pylinter.py\", line 1062, in check_astroid_module\r\n    retval = self._check_astroid_module(\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\lint\\pylinter.py\", line 1107, in _check_astroid_module\r\n    walker.walk(ast_node)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\utils\\ast_walker.py\", line 75, in walk\r\n    self.walk(child)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\utils\\ast_walker.py\", line 75, in walk\r\n    self.walk(child)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\utils\\ast_walker.py\", line 75, in walk\r\n    self.walk(child)\r\n  [Previous line repeated 2 more times]\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\utils\\ast_walker.py\", line 72, in walk\r\n    callback(astroid)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\checkers\\refactoring.py\", line 720, in visit_call\r\n    self._check_raising_stopiteration_in_generator_next_call(node)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\checkers\\refactoring.py\", line 761, in _check_raising_stopiteration_in_generator_next_call\r\n    inferred = utils.safe_infer(node.func)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\checkers\\utils.py\", line 1124, in safe_infer\r\n    inferred_types.add(_get_python_type_of_node(value))\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\pylint\\checkers\\utils.py\", line 1103, in _get_python_type_of_node\r\n    return pytype()\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\astroid\\scoped_nodes.py\", line 1185, in pytype\r\n    if \"method\" in self.type:\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\astroid\\decorators.py\", line 72, in __get__\r\n    val = self.wrapped(inst)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\astroid\\scoped_nodes.py\", line 1461, in type\r\n    for decorator in self.extra_decorators:\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\astroid\\decorators.py\", line 72, in __get__\r\n    val = self.wrapped(inst)\r\n  File \"D:\\Program Files\\Python38\\lib\\site-packages\\astroid\\scoped_nodes.py\", line 1419, in extra_decorators\r\n    frame = self.parent.frame()\r\nAttributeError: 'NoneType' object has no attribute 'frame'\r\n```\r\n\r\n### Expected behavior\r\nNormal pylint run without exception.\r\n\r\n### ``python -c \"from astroid import __pkginfo__; print(__pkginfo__.version)\"`` output\r\nPython 3.8.3\r\nPylint 2.5.3\r\nastroid 2.4.1\r\n\n",
  "pull_number": 874,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/tests/unittest_regrtest.py b/tests/unittest_regrtest.py\nindex 17668edd23..b75e3dfe47 100644\n--- a/tests/unittest_regrtest.py\n+++ b/tests/unittest_regrtest.py\n@@ -343,5 +343,16 @@ def format(self):\n     assert isinstance(found[0], nodes.FunctionDef)\n \n \n+def test_crash_in_dunder_inference_prevented():\n+    code = \"\"\"\n+    class MyClass():\n+        def fu(self, objects):\n+            delitem = dict.__delitem__.__get__(self, dict)\n+            delitem #@\n+    \"\"\"\n+    inferred = next(extract_node(code).infer())\n+    assert \"builtins.dict.__delitem__\" == inferred.qname()\n+\n+\n if __name__ == \"__main__\":\n     unittest.main()\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/a8bde99124c4213c26fd92a4b287786e5f4829ed"
}