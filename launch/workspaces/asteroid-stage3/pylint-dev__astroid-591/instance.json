{
  "all_hints_text": "Yes, should be great to fix this.\n\n",
  "base_commit": "be3ba810d57253942cdc9e0639a7ad0043f7a688",
  "commit_urls": [
    "https://github.com/pylint-dev/astroid/commit/7e455d87875c3ab9e3f7c97c7ae46619c4d2868b"
  ],
  "created_at": "2018-07-09T04:17:27Z",
  "hints_text": "Yes, should be great to fix this.\n\n",
  "instance_id": "pylint-dev__astroid-591",
  "issue_numbers": [
    581
  ],
  "language": "python",
  "patch": "diff --git a/astroid/bases.py b/astroid/bases.py\nindex c7b0cbc330..caf230f12e 100644\n--- a/astroid/bases.py\n+++ b/astroid/bases.py\n@@ -343,9 +343,7 @@ def infer_call_result(self, caller, context):\n         # instance of the class given as first argument.\n         if (self._proxied.name == '__new__' and\n                 self._proxied.parent.frame().qname() == '%s.object' % BUILTINS):\n-            # XXX Avoid issue with type.__new__ inference.\n-            # https://github.com/PyCQA/astroid/issues/581\n-            if caller.args and len(caller.args) == 1:\n+            if caller.args:\n                 node_context = context.extra_context.get(caller.args[0])\n                 infer = caller.args[0].infer(context=node_context)\n             else:\n@@ -440,10 +438,7 @@ def infer_call_result(self, caller, context=None):\n         if (self.bound.__class__.__name__ == 'ClassDef'\n                 and self.bound.name == 'type'\n                 and self.name == '__new__'\n-                and len(caller.args) == 4\n-                # TODO(cpopa): this check shouldn't be needed.\n-                and self._proxied.parent.frame().qname() == '%s.object' % BUILTINS):\n-\n+                and len(caller.args) == 4):\n             # Check if we have an ``type.__new__(mcs, name, bases, attrs)`` call.\n             new_cls = self._infer_type_new_call(caller, context)\n             if new_cls:\ndiff --git a/astroid/scoped_nodes.py b/astroid/scoped_nodes.py\nindex 1eef141607..3b1cc50a62 100644\n--- a/astroid/scoped_nodes.py\n+++ b/astroid/scoped_nodes.py\n@@ -2366,8 +2366,8 @@ def igetattr(self, name, context=None, class_context=True):\n         context = contextmod.copy_context(context)\n         context.lookupname = name\n         try:\n-            attrs = self.getattr(name, context, class_context=class_context)\n-            for inferred in bases._infer_stmts(attrs, context, frame=self):\n+            attr = self.getattr(name, context, class_context=class_context)[0]\n+            for inferred in bases._infer_stmts([attr], context, frame=self):\n                 # yield Uninferable object instead of descriptors when necessary\n                 if (not isinstance(inferred, node_classes.Const)\n                         and isinstance(inferred, bases.Instance)):\n",
  "problem_statement": "type.__new__ attribute infers to both type.__new__ and object.__new__\nExample:\r\n\r\n```python\r\nimport astroid\r\nprint(astroid.extract_node(\"\"\"\r\ntype.__new__\r\n\"\"\").inferred())\r\n```\r\n\r\nResults in `[<BoundMethod __new__ of builtins.type at 0x126350295329928, <BoundMethod __new__ of builtins.object at 0x126350078306680]`\r\nThe above code should only infer to BoundMethod of `type.__new__`\r\n\r\nThis is causing some issues and hacks in the code base including https://github.com/PyCQA/astroid/blob/master/astroid/bases.py#L452 I think\n",
  "pull_number": 591,
  "repo": "pylint-dev/astroid",
  "test_patch": "diff --git a/astroid/tests/unittest_inference.py b/astroid/tests/unittest_inference.py\nindex 353ac23baf..39f43435ae 100644\n--- a/astroid/tests/unittest_inference.py\n+++ b/astroid/tests/unittest_inference.py\n@@ -3404,7 +3404,8 @@ class MetaBook(type):\n         ''')\n         inferred = next(ast_node.infer())\n         self.assertIsInstance(inferred, nodes.ClassDef)\n-        titles = [title.value for title in inferred.igetattr('title')]\n+        titles = [title.value for attr in inferred.getattr('title')\n+                  for title in attr.inferred()]\n         self.assertEqual(titles, ['Catch 22', 'Ubik', 'Grimus'])\n \n     @unittest.expectedFailure\n@@ -4684,5 +4685,32 @@ def test_limit_inference_result_amount():\n     assert util.Uninferable in result_limited\n \n \n+def test_attribute_inference_should_not_access_base_classes():\n+    \"\"\"attributes of classes should mask ancestor attribues\"\"\"\n+    code = \"\"\"\n+    type.__new__ #@\n+    \"\"\"\n+    res = extract_node(code).inferred()\n+    assert len(res) == 1\n+    assert res[0].parent.name == \"type\"\n+\n+\n+def test_attribute_mro_object_inference():\n+    \"\"\"\n+    Inference should only infer results from the first available method\n+    \"\"\"\n+    inferred = extract_node(\"\"\"\n+    class A:\n+        def foo(self):\n+            return 1\n+    class B(A):\n+        def foo(self):\n+            return 2\n+    B().foo() #@\n+    \"\"\").inferred()\n+    assert len(inferred) == 1\n+    assert inferred[0].value == 2\n+\n+\n if __name__ == '__main__':\n     unittest.main()\n",
  "commit_url": "https://github.com/pylint-dev/astroid/tree/be3ba810d57253942cdc9e0639a7ad0043f7a688"
}